---
title: "<center> <h1> **Risk Methodology Assessment (RMA)** </h1> </center>"

#date: "null"
output:
  html_document:
    code_download: true
theme: lumen
runtime: shiny
---
<style type="text/css">

h1.title {
  font-size: 38px;
  color: mediumblue;
}
</style>
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(fmsb)
library(shinyBS)
library(shinyjs)
library(plotly)
library(kableExtra)
library(DT)  
library(factoextra)

colorize <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color, 
      x)
  } else x
}
```

#  {.tabset}

## **`r colorize("RMA", "mediumblue")`**
The objective of RMA is to identify and assess risks in a clinical study, which can be minimized by monitoring activities	
	
1. It is therefore necessary to identify and assess risks that are directly related to the responsibilities during study monitoring	
2. In order to decide which risks are greatest in a study and thus should have significant influence on the monitoring planning, each risk must be examined in terms of:
	
	a) What is the potential impact on the study. Here, the points listed in ICH E6(R2) are appropriate as subcategories for the purpose of monitoring.						
	Note: impact – A risk, by its very nature, always has a negative impact. However, the size of the impact varies in terms of categories:
	
	    * Well-being/safety of subjects   
	        - A score of 3
	    * Reliability of data
	        - A score of 2
	    * GCP/protocol compliance
	        - A score of 1
			    
	b) Furthermore, the likelihood of the occurrence of such a risk must be decided. Experience values should be used as a basis for the sub-categories, e.g. from overviews of authority inspections of the findings observed. Probability takes a values between 1 and 5. 
							
	c) In addition, it is important to assess to what extent an existing risk can be detected and possibly minimized by monitoring and, if so, by which monitoring method.						
	A basic distinction should be made between onsite and remote monitoring activities and the frequency with which these activities are necessary to minimize/avoid risk. For this reason detectability takes a value of 1 (remote) or 2 (onsite).
	
### **`r colorize("Authors", "mediumblue")`**

[**Firas Fneish<sup>1</sup>**](https://firasfneish-statistics-r.netlify.app/), Frank Schaarschmidt<sup>1</sup>, Gerhard Fortwengel<sup>2</sup>

  1. Leibniz Universität Hannover, Hannover, Germany
  2. Hochschule Hannover, Hannover, Germany

### **`r colorize("Disclaimer", "red")`**
Any User using this methodology takes full and complete responsibility for ensuring compliance with all laws and regulations in the area the trial is being conducted in. **`r colorize("We take no responsibility in any result in the output assessment of the risks covered or in the overall assessment", "red")`**. The syntax is available on Github, the user can download and modify it for their own benefit.


## **`r colorize("Essential Documents", "mediumblue")`**
### **1. Missing/Lack of essential document(s)**
```{r echo=FALSE}
inputPanel(

    textInput("LACK_ESSENTIAL", "Type of document", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_LACK_ESSENTIAL", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3, 2, 1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_LACK_ESSENTIAL", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_LACK_ESSENTIAL", "Detectabilty", NA, min = 1, max = 2), 
  checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

  )

  A2_LACK_ESSENTIAL <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_LACK_ESSENTIAL))
      
      
    })

 title_LACK_ESSENTIAL= renderText({ input$LACK_ESSENTIAL })

 Area_1_LACK_ESSENTIAL <- reactive({ 0.5*as.numeric(A2_LACK_ESSENTIAL())*input$Prob_LACK_ESSENTIAL*sin(120)  }) 
 Area_2_LACK_ESSENTIAL <- reactive({ 0.5*as.numeric(A2_LACK_ESSENTIAL())*input$Det_LACK_ESSENTIAL*sin(120)  }) 

Area_3_LACK_ESSENTIAL <- reactive({ 0.5*input$Prob_LACK_ESSENTIAL*input$Det_LACK_ESSENTIAL*sin(120)  }) 
Area_4_LACK_ESSENTIAL <-  reactive({ 
 round( (Area_1_LACK_ESSENTIAL()+Area_2_LACK_ESSENTIAL()+Area_3_LACK_ESSENTIAL() ) /15.09589*100,
        digits = 0 )
  })
      
renderPlot({
  
        title_LACK_ESSENTIAL= renderText({ input$LACK_ESSENTIAL })
       Var1 <-as.numeric(A2_LACK_ESSENTIAL())
         Var2 <-input$Prob_LACK_ESSENTIAL
         Var3 <- input$Det_LACK_ESSENTIAL
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                   Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_LACK_ESSENTIAL()         )
    text(x = 0.8, y = 0.6, ifelse(paste((Area_4_LACK_ESSENTIAL()))=="NA", "Total Area",
                                  paste((Area_4_LACK_ESSENTIAL()))), cex = 1.6, col = "black")
   
   })
 
  A2_LACK_ESSENTIAL_Monitoring <- renderText({    
          Monitoring_lack_essential <- input$inCheckboxGroup_Monitoring_Techniques
          })

  
  
 # renderPrint(A2_LACK_ESSENTIAL())  
```

### **2. Receipt of IMP shipment to site (Delay, ect.)**
```{r echo=FALSE}

 
inputPanel(

    textInput("Receipt_IMP", "A risk might be ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Receipt_IMP", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Receipt_IMP", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Receipt_IMP", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_receiptimp", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Receipt_IMP <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Receipt_IMP))
      
    })


 title_Receipt_IMP= renderText({ input$Receipt_IMP })
 
 
    Area_1_Receipt_IMP <- reactive({ 0.5*as.numeric(A2_Receipt_IMP())*input$Prob_Receipt_IMP*sin(120)  }) 
 Area_2_Receipt_IMP <- reactive({ 0.5*as.numeric(A2_Receipt_IMP())*input$Det_Receipt_IMP*sin(120)  }) 

Area_3_Receipt_IMP <- reactive({ 0.5*input$Prob_Receipt_IMP*input$Det_Receipt_IMP*sin(120)  }) 
Area_4_Receipt_IMP <-  reactive({ 
round(  (Area_1_Receipt_IMP()+Area_2_Receipt_IMP()+Area_3_Receipt_IMP() ) /15.09589*100,
        digits = 0 )
  }) 

 renderPlot({
   
   

     
       Var1 <-as.numeric(A2_Receipt_IMP())
         Var2 <-input$Prob_Receipt_IMP
         Var3 <- input$Det_Receipt_IMP
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Receipt_IMP()) 
       #  text(x = 0.5, y = 0.8, paste(round(Area_4_Receipt_IMP())), cex = 1.6, col = "black")
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Receipt_IMP()))=="NA", "Total Area", paste(round(Area_4_Receipt_IMP()))), cex = 1.6, col = "black")
   
   })

 
   A2_recieptimp_Monitoring <- renderText({    
      
    Monitoring_receiptimp <- input$inCheckboxGroup_Monitoring_Techniques_receiptimp
      
    })
  
 
```

### **3. Records of blood samples shipment to the central laboratories(Delay, etc.)**
```{r echo=FALSE}
 
inputPanel(

    textInput("Records_blood", "A risk might be ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Records_blood", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Records_blood", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Records_blood", "Detectabilty", NA, min = 1, max = 2), 
  checkboxGroupInput("inCheckboxGroup_Monitoring_REcords_blood", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))


         )



  A2_Records_blood <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Records_blood))
      
      
    })



 title_Records_blood= renderText({ input$Records_blood })

 
    Area_1_Records_blood<- reactive({ 0.5*as.numeric(A2_Records_blood())*input$Prob_Records_blood*sin(120)  }) 
 Area_2_Records_blood <- reactive({ 0.5*as.numeric(A2_Records_blood())*input$Det_Records_blood*sin(120)  }) 

Area_3_Records_blood <- reactive({ 0.5*input$Prob_Records_blood*input$Det_Records_blood*sin(120)  }) 
Area_4_Records_blood <-  reactive({ 
  round( (Area_1_Records_blood()+Area_2_Records_blood()+Area_3_Records_blood() ) /15.09589*100,
        digits = 0 )
          
          
          }) 
 
 renderPlot({
   

       Var1 <-as.numeric(A2_Records_blood())
         Var2 <-input$Prob_Records_blood
         Var3 <- input$Det_Records_blood
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Records_blood())
                  text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Records_blood()))=="NA", "Total Area",
                                  paste(round(Area_4_Records_blood()))), cex = 1.6, col = "black")

   
   })
 
 
  A2_REcords_blood_Monitoring <- renderText({    
      
    Monitoring_REcords_blood <- input$inCheckboxGroup_Monitoring_REcords_blood
         })
  
 A2_REcords_blood_Monitoring

```

### **4. Having incomplete documentation**
```{r echo=FALSE}
 
inputPanel(

    textInput("Incomplete_screening_documen", "Dropping out, missing appointments", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Incomplete_screening_documen", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Incomplete_screening_documen", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Incomplete_screening_documen", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Incomplete_screening_documen", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Incomplete_screening_documen <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Incomplete_screening_documen))
      
      
    })



 title_Incomplete_screening_documen= renderText({ input$Incomplete_screening_documen })


 Area_1_Incomplete_screening_documen <- reactive({0.5*as.numeric(A2_Incomplete_screening_documen())*input$Prob_Incomplete_screening_documen*sin(120)  }) 

 Area_2_Incomplete_screening_documen <- reactive({ 0.5*as.numeric(A2_Incomplete_screening_documen())*input$Det_Incomplete_screening_documen*sin(120)  }) 

Area_3_Incomplete_screening_documen <- reactive({ 0.5*input$Prob_Incomplete_screening_documen*input$Det_Incomplete_screening_documen*sin(120)  }) 
Area_4_Incomplete_screening_documen <-  reactive({
round((  Area_1_Incomplete_screening_documen()+Area_2_Incomplete_screening_documen()+Area_3_Incomplete_screening_documen() 
  
) /15.09589*100,
        digits = 0 )
              
         
         
  }) 
 
 
 
  renderPlot({
   

       Var1 <-as.numeric(A2_Incomplete_screening_documen())
         Var2 <-input$Prob_Incomplete_screening_documen
         Var3 <- input$Det_Incomplete_screening_documen
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Incomplete_screening_documen())                           
              text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Incomplete_screening_documen()))=="NA", "Total Area",
                                  paste(round(Area_4_Incomplete_screening_documen()))), cex = 1.6, col = "black")

   })

 
 A2_Incomplete_screening_documen_Monitoring <- renderText({    
      
    Monitoring_Incomplete_screening_documen <- input$inCheckboxGroup_Monitoring_Incomplete_screening_documen
         })
 
 
```

### **5. Incomplete screening list (Not following screening appointments)**
```{r echo=FALSE}
 
inputPanel(

    textInput("Incomplete_screening_list", "A risk might be (patients missing screening date, dropping out, screening not documents..)", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Incomplete_screening_list", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Incomplete_screening_list", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Incomplete_screening_list", "Detectabilty", NA, min = 1, max = 2), 
    checkboxGroupInput("inCheckboxGroup_Monitoring_Incomplete_screening_list", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Incomplete_screening_list <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Incomplete_screening_list))
      
      
    })



 title_Incomplete_screening_list= renderText({ input$Incomplete_screening_list })


 
     Area_1_Incomplete_screening_list <- reactive({ 0.5*as.numeric(A2_Incomplete_screening_list())*input$Prob_Incomplete_screening_list*sin(120)  }) 
 Area_2_Incomplete_screening_list <- reactive({ 0.5*as.numeric(A2_Incomplete_screening_list())*input$Det_Incomplete_screening_list*sin(120)  }) 

Area_3_Incomplete_screening_list <- reactive({ 0.5*input$Prob_Incomplete_screening_list*input$Det_Incomplete_screening_list*sin(120)  }) 
Area_4_Incomplete_screening_list <-  reactive({
  
  round(( Area_1_Incomplete_screening_list()+Area_2_Incomplete_screening_list()+Area_3_Incomplete_screening_list()
          
           ) /15.09589*100,
        digits = 0 )
          
  }) 
  

renderPlot({
   
       Var1 <-as.numeric(A2_Incomplete_screening_list())
         Var2 <-input$Prob_Incomplete_screening_list
         Var3 <- input$Det_Incomplete_screening_list
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Incomplete_screening_list())                           
           text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Incomplete_screening_list()))=="NA", "Total Area",
                                  paste(round(Area_4_Incomplete_screening_list()))), cex = 1.6, col = "black")

   })
 
 
 A2_Incomplete_screening_list_Monitoring <- renderText({    
      
    Monitoring_Incomplete_screening_list <- input$inCheckboxGroup_Monitoring_Incomplete_screening_list
         })

 

```

### **6. lack of contemporaneous independent copy of the CRF filed on site**
```{r echo=FALSE}
 
inputPanel(

    textInput("CRF_issue_copy", "CRF issues such as", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_CRF_issue_copy", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_CRF_issue_copy", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_CRF_issue_copy", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_CRF_issue_copy", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_CRF_issue_copy <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_CRF_issue_copy))
      
      
    })



 title_CRF_issue_copy= renderText({ input$CRF_issue_copy })

 
  Area_1_CRF_issue_copy <- reactive({ 0.5*as.numeric(A2_CRF_issue_copy())*input$Prob_CRF_issue_copy*sin(120)  }) 
 Area_2_CRF_issue_copy <- reactive({ 0.5*as.numeric(A2_CRF_issue_copy())*input$Det_CRF_issue_copy*sin(120)  }) 

Area_3_CRF_issue_copy <- reactive({ 0.5*input$Prob_CRF_issue_copy*input$Det_CRF_issue_copy*sin(120)  }) 
Area_4_CRF_issue_copy <-  reactive({ 
  
  round(( Area_1_CRF_issue_copy()+Area_2_CRF_issue_copy()+Area_3_CRF_issue_copy()  ) /15.09589*100,
        digits = 0 )
          
          }) 
 
 renderPlot({
   
     
       Var1 <-as.numeric(A2_CRF_issue_copy())
         Var2 <-input$Prob_CRF_issue_copy
         Var3 <- input$Det_CRF_issue_copy
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_CRF_issue_copy())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_CRF_issue_copy()))=="NA", "Total Area",
                                  paste(round(Area_4_CRF_issue_copy()))), cex = 1.6, col = "black")
   })

 
  A2_CRF_issue_copy_Monitoring <- renderText({    
      
    Monitoring_CRF_issue_copy <- input$inCheckboxGroup_Monitoring_CRF_issue_copy
         })
   

```


```{r PDF_Essential_Documents, echo=FALSE}
 mainPanel( downloadButton(outputId = "download_essential_document", label = "Download Essential Document Section Report"))


    output$download_essential_document <- downloadHandler(
   filename = function() { paste("Essential Document", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(3,2))

     ##1st
    title_LACK_ESSENTIAL= renderText({ input$LACK_ESSENTIAL })
     
    Area_1_LACK_ESSENTIAL <- reactive({ 0.5*as.numeric(A2_LACK_ESSENTIAL())*input$Prob_LACK_ESSENTIAL*sin(120)  }) 
 Area_2_LACK_ESSENTIAL <- reactive({ 0.5*as.numeric(A2_LACK_ESSENTIAL())*input$Det_LACK_ESSENTIAL*sin(120)  }) 

Area_3_LACK_ESSENTIAL <- reactive({ 0.5*input$Prob_LACK_ESSENTIAL*input$Det_LACK_ESSENTIAL*sin(120)  }) 
Area_4_LACK_ESSENTIAL <-  reactive({ Area_1_LACK_ESSENTIAL()+Area_2_LACK_ESSENTIAL()+Area_3_LACK_ESSENTIAL()  }) 

       Var1 <-as.numeric(A2_LACK_ESSENTIAL())
         Var2 <-input$Prob_LACK_ESSENTIAL
         Var3 <- input$Det_LACK_ESSENTIAL
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
 radarchart(D, axistype=2, title=title_LACK_ESSENTIAL()         )
          text(x = 0.5, y = 0.8, paste(round(Area_4_LACK_ESSENTIAL())), 
     cex = 1.6, col = "black")
 ###2nd         
 title_Receipt_IMP= renderText({ input$Receipt_IMP })
       

    Area_1_Receipt_IMP <- reactive({ 0.5*as.numeric(A2_Receipt_IMP())*input$Prob_Receipt_IMP*sin(120)  }) 
 Area_2_Receipt_IMP <- reactive({ 0.5*as.numeric(A2_Receipt_IMP())*input$Det_Receipt_IMP*sin(120)  }) 

Area_3_Receipt_IMP <- reactive({ 0.5*input$Prob_Receipt_IMP*input$Det_Receipt_IMP*sin(120)  }) 
Area_4_Receipt_IMP <-  reactive({ Area_1_Receipt_IMP()+Area_2_Receipt_IMP()+Area_3_Receipt_IMP()  }) 

       Var1 <-as.numeric(A2_Receipt_IMP())
         Var2 <-input$Prob_Receipt_IMP
         Var3 <- input$Det_Receipt_IMP
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
 radarchart(D, axistype=2, title=title_Receipt_IMP()         )
          text(x = 0.5, y = 0.8, paste(round(Area_4_Receipt_IMP())), 
     cex = 1.6, col = "black")
          
          
           ###3rd         
 title_Records_blood= renderText({ input$Records_blood })

           Area_1_Records_blood<- reactive({ 0.5*as.numeric(A2_Records_blood())*input$Prob_Records_blood*sin(120)  }) 
 Area_2_Records_blood <- reactive({ 0.5*as.numeric(A2_Records_blood())*input$Det_Records_blood*sin(120)  }) 

Area_3_Records_blood <- reactive({ 0.5*input$Prob_Records_blood*input$Det_Records_blood*sin(120)  }) 
Area_4_Records_blood <-  reactive({ Area_1_Records_blood()+Area_2_Records_blood()+Area_3_Records_blood()  }) 

     
       Var1 <-as.numeric(A2_Records_blood())
         Var2 <-input$Prob_Records_blood
         Var3 <- input$Det_Records_blood
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Records_blood())
                  text(x = 0.5, y = 0.8, paste(round(Area_4_Records_blood())), cex = 1.6, col = "black")

                  ## 4th
           title_Incomplete_screening_documen= renderText({ input$Incomplete_screening_documen })

          Area_1_Incomplete_screening_documen <- reactive({0.5*as.numeric(A2_Incomplete_screening_documen())*input$Prob_Incomplete_screening_documen*sin(120)  }) 

 Area_2_Incomplete_screening_documen <- reactive({ 0.5*as.numeric(A2_Incomplete_screening_documen())*input$Det_Incomplete_screening_documen*sin(120)  }) 

Area_3_Incomplete_screening_documen <- reactive({ 0.5*input$Prob_Incomplete_screening_documen*input$Det_Incomplete_screening_documen*sin(120)  }) 
Area_4_Incomplete_screening_documen <-  reactive({ Area_1_Incomplete_screening_documen()+Area_2_Incomplete_screening_documen()+Area_3_Incomplete_screening_documen()  }) 

     
       Var1 <-as.numeric(A2_Incomplete_screening_documen())
         Var2 <-input$Prob_Incomplete_screening_documen
         Var3 <- input$Det_Incomplete_screening_documen
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Incomplete_screening_documen())                           
            text(x = 0.5, y = 0.8, paste(round(Area_4_Incomplete_screening_documen())), cex = 1.6, col = "black")
  
            # 5th
             title_Incomplete_screening_list= renderText({ input$Incomplete_screening_list })
   
    Area_1_Incomplete_screening_list <- reactive({ 0.5*as.numeric(A2_Incomplete_screening_list())*input$Prob_Incomplete_screening_list*sin(120)  }) 
 Area_2_Incomplete_screening_list <- reactive({ 0.5*as.numeric(A2_Incomplete_screening_list())*input$Det_Incomplete_screening_list*sin(120)  }) 

Area_3_Incomplete_screening_list <- reactive({ 0.5*input$Prob_Incomplete_screening_list*input$Det_Incomplete_screening_list*sin(120)  }) 
Area_4_Incomplete_screening_list <-  reactive({ Area_1_Incomplete_screening_list()+Area_2_Incomplete_screening_list()+Area_3_Incomplete_screening_list()  }) 

     
       Var1 <-as.numeric(A2_Incomplete_screening_list())
         Var2 <-input$Prob_Incomplete_screening_list
         Var3 <- input$Det_Incomplete_screening_list
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Incomplete_screening_list())                           
            text(x = 0.5, y = 0.8, paste(round(Area_4_Incomplete_screening_list())), cex = 1.6, col = "black")
     # 6th
          title_CRF_issue_copy= renderText({ input$CRF_issue_copy })
  Area_1_CRF_issue_copy <- reactive({ 0.5*as.numeric(A2_CRF_issue_copy())*input$Prob_CRF_issue_copy*sin(120)  }) 
 Area_2_CRF_issue_copy <- reactive({ 0.5*as.numeric(A2_CRF_issue_copy())*input$Det_CRF_issue_copy*sin(120)  }) 

Area_3_CRF_issue_copy <- reactive({ 0.5*input$Prob_CRF_issue_copy*input$Det_CRF_issue_copy*sin(120)  }) 
Area_4_CRF_issue_copy <-  reactive({ Area_1_CRF_issue_copy()+Area_2_CRF_issue_copy()+Area_3_CRF_issue_copy()  }) 

     
       Var1 <-as.numeric(A2_CRF_issue_copy())
         Var2 <-input$Prob_CRF_issue_copy
         Var3 <- input$Det_CRF_issue_copy
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_CRF_issue_copy())                           
            text(x = 0.5, y = 0.8, paste(round(Area_4_CRF_issue_copy())), cex = 1.6, col = "black")

          dev.off()
   }
  )



```

## **`r colorize("SOPs", "mediumblue")`**


### **1.SOPs won't be followed/used**
```{r echo=FALSE}
 
inputPanel(

    textInput("SOPs_usage", "SOPs usage", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_SOPs_usage", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_SOPs_usage", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_SOPs_usage", "Detectabilty", NA, min = 1, max = 2), 
     checkboxGroupInput("inCheckboxGroup_Monitoring_SOPs_usage", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))


         )



  A2_SOPs_usage <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_SOPs_usage))
      
      
    })



 title_SOPs_usage= renderText({ input$SOPs_usage })


    Area_1_SOPs_usage <- reactive({ 0.5*as.numeric(A2_SOPs_usage())*input$Prob_SOPs_usage*sin(120)  }) 
 Area_2_SOPs_usage <- reactive({ 0.5*as.numeric(A2_SOPs_usage())*input$Det_SOPs_usage*sin(120)  }) 

Area_3_SOPs_usage <- reactive({ 0.5*input$Prob_SOPs_usage*input$Det_SOPs_usage*sin(120)  }) 
Area_4_SOPs_usage <-  reactive({ 
  
  round(( Area_1_SOPs_usage()+Area_2_SOPs_usage()+Area_3_SOPs_usage()  ) /15.09589*100,
        digits = 0 )
           
          }) 
 
 
  renderPlot({
   
       Var1 <-as.numeric(A2_SOPs_usage())
         Var2 <-input$Prob_SOPs_usage
         Var3 <- input$Det_SOPs_usage
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_SOPs_usage()) 
                     text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_SOPs_usage()))=="NA", "Total Area",
                                  paste(round(Area_4_SOPs_usage()))), cex = 1.6, col = "black")
   
   })
 
 
  A2_SOPs_usage_Monitoring <- renderText({    
          Monitoring_SOPs_usage <- input$inCheckboxGroup_Monitoring_SOPs_usage
          })

```


### **2. SOPs won't be updated as required**
```{r echo=FALSE}
 
inputPanel(

    textInput("SOPs_update", "SOPs update", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_SOPs_update", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_SOPs_update", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_SOPs_update", "Detectabilty", NA, min = 1, max = 2), 
  checkboxGroupInput("inCheckboxGroup_Monitoring_SOPs_update", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_SOPs_update <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_SOPs_update))
      
      
    })



 title_SOPs_update= renderText({ input$SOPs_update })


  Area_1_SOPs_update <- reactive({ 0.5*as.numeric(A2_SOPs_update())*input$Prob_SOPs_update*sin(120)  }) 
 Area_2_SOPs_update <- reactive({ 0.5*as.numeric(A2_SOPs_update())*input$Det_SOPs_update*sin(120)  }) 

Area_3_SOPs_update <- reactive({ 0.5*input$Prob_SOPs_update*input$Det_SOPs_update*sin(120)  }) 
Area_4_SOPs_update <-  reactive({ 
  round(( Area_1_SOPs_update()+Area_2_SOPs_update()+Area_3_SOPs_update()   ) /15.09589*100,
        digits = 0 )
          }) 

 
  renderPlot({
   
       Var1 <-as.numeric(A2_SOPs_update())
         Var2 <-input$Prob_SOPs_update
         Var3 <- input$Det_SOPs_update
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_SOPs_update()) 
                              text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_SOPs_update()))=="NA", "Total Area",
                                  paste(round(Area_4_SOPs_update()))), cex = 1.6, col = "black")

   
   })
 
 
   A2_SOPs_update_Monitoring <- renderText({    
          Monitoring_SOPs_update <- input$inCheckboxGroup_Monitoring_SOPs_update
          })

```




### **3. The implementation of an efficient quality management system by the Sponsor**
```{r echo=FALSE}
 
inputPanel(

    textInput("Sponsor_efficient_quality_management_system", "SOPs ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Sponsor_efficient_quality_management_system", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Sponsor_efficient_quality_management_system", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Sponsor_efficient_quality_management_system", "Detectabilty", NA, min = 1, max = 2), 
  checkboxGroupInput("inCheckboxGroup_Monitoring_Sponsor_efficient_quality_management_system", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Sponsor_efficient_quality_management_system <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Sponsor_efficient_quality_management_system))
      
      
    })


 title_SOPs_Sponsor_efficient_quality_management_system= renderText({ input$Sponsor_efficient_quality_management_system })


    Area_1_Sponsor_efficient_quality_management_system  <- reactive({ 0.5*as.numeric(A2_Sponsor_efficient_quality_management_system())*input$Prob_Sponsor_efficient_quality_management_system*sin(120)  }) 
 Area_2_Sponsor_efficient_quality_management_system  <- reactive({ 0.5*as.numeric(A2_Sponsor_efficient_quality_management_system())*input$Det_Sponsor_efficient_quality_management_system*sin(120)  }) 

Area_3_Sponsor_efficient_quality_management_system  <- reactive({ 0.5*input$Prob_Sponsor_efficient_quality_management_system*input$Det_Sponsor_efficient_quality_management_system*sin(120)  }) 
Area_4_Sponsor_efficient_quality_management_system  <-  reactive({
  round(( Area_1_Sponsor_efficient_quality_management_system()+Area_2_Sponsor_efficient_quality_management_system()+Area_3_Sponsor_efficient_quality_management_system() ) /15.09589*100,
        digits = 0 )
          
  }) 
 
 
  renderPlot({
   
       Var1 <-as.numeric(A2_Sponsor_efficient_quality_management_system())
         Var2 <-input$Prob_Sponsor_efficient_quality_management_system
         Var3 <- input$Det_Sponsor_efficient_quality_management_system
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_SOPs_Sponsor_efficient_quality_management_system())                           
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Sponsor_efficient_quality_management_system()))=="NA", "Total Area",
                                  paste(round(Area_4_Sponsor_efficient_quality_management_system()))), cex = 1.6, col = "black")

   })
 
 
 
  A2_Sponsor_efficient_quality_management_system_Monitoring <- renderText({    
          Monitoring_Sponsor_efficient_quality_management_system <- input$inCheckboxGroup_Monitoring_Sponsor_efficient_quality_management_system
          })

```



```{r PDF_SOPs, echo=FALSE}

 mainPanel( downloadButton(outputId = "download_Sponsor_efficient_quality_management_system", label = "Download SOPs Report"))


    output$download_Sponsor_efficient_quality_management_system <- downloadHandler(
   filename = function() { paste("SOPs Report", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(3,1))
## 1st
 title_SOPs_usage= renderText({ input$SOPs_usage })

   Area_1_SOPs_usage <- reactive({ 0.5*as.numeric(A2_SOPs_usage())*input$Prob_SOPs_usage*sin(120)  }) 
 Area_2_SOPs_usage <- reactive({ 0.5*as.numeric(A2_SOPs_usage())*input$Det_SOPs_usage*sin(120)  }) 

Area_3_SOPs_usage <- reactive({ 0.5*input$Prob_SOPs_usage*input$Det_SOPs_usage*sin(120)  }) 
Area_4_SOPs_usage <-  reactive({ Area_1_SOPs_usage()+Area_2_SOPs_usage()+Area_3_SOPs_usage()  }) 

       Var1 <-as.numeric(A2_SOPs_usage())
         Var2 <-input$Prob_SOPs_usage
         Var3 <- input$Det_SOPs_usage
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_SOPs_usage()) 
                     text(x = 0.5, y = 0.8, paste(round(Area_4_SOPs_usage())), cex = 1.6, col = "black")

 #  2nd
   
 title_SOPs_update= renderText({ input$SOPs_update })

   Area_1_SOPs_update <- reactive({ 0.5*as.numeric(A2_SOPs_update())*input$Prob_SOPs_update*sin(120)  }) 
 Area_2_SOPs_update <- reactive({ 0.5*as.numeric(A2_SOPs_update())*input$Det_SOPs_update*sin(120)  }) 

Area_3_SOPs_update <- reactive({ 0.5*input$Prob_SOPs_update*input$Det_SOPs_update*sin(120)  }) 
Area_4_SOPs_update <-  reactive({ Area_1_SOPs_update()+Area_2_SOPs_update()+Area_3_SOPs_update()  }) 

     
       Var1 <-as.numeric(A2_SOPs_update())
         Var2 <-input$Prob_SOPs_update
         Var3 <- input$Det_SOPs_update
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_SOPs_update()) 
                              text(x = 0.5, y = 0.8, paste(round(Area_4_SOPs_update())), cex = 1.6, col = "black")

     # 3rd    
         
 title_SOPs_Sponsor_efficient_quality_management_system= renderText({ input$Sponsor_efficient_quality_management_system })


   
   Area_1_Sponsor_efficient_quality_management_system  <- reactive({ 0.5*as.numeric(A2_Sponsor_efficient_quality_management_system())*input$Prob_Sponsor_efficient_quality_management_system*sin(120)  }) 
 Area_2_Sponsor_efficient_quality_management_system  <- reactive({ 0.5*as.numeric(A2_Sponsor_efficient_quality_management_system())*input$Det_Sponsor_efficient_quality_management_system*sin(120)  }) 

Area_3_Sponsor_efficient_quality_management_system  <- reactive({ 0.5*input$Prob_Sponsor_efficient_quality_management_system*input$Det_Sponsor_efficient_quality_management_system*sin(120)  }) 
Area_4_Sponsor_efficient_quality_management_system  <-  reactive({ Area_1_Sponsor_efficient_quality_management_system()+Area_2_Sponsor_efficient_quality_management_system()+Area_3_Sponsor_efficient_quality_management_system()  }) 

     
       Var1 <-as.numeric(A2_Sponsor_efficient_quality_management_system())
         Var2 <-input$Prob_Sponsor_efficient_quality_management_system
         Var3 <- input$Det_Sponsor_efficient_quality_management_system
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_SOPs_Sponsor_efficient_quality_management_system())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_Sponsor_efficient_quality_management_system())), cex = 1.6, col = "black")
 
          dev.off()
   }
  )
```



## **`r colorize("Source Documentation", "mediumblue")`**
### **1. Risk of having discrepancies between source data and data reported in the CSR**
```{r echo=FALSE}

inputPanel(

    textInput("Discrepancies_data", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Discrepancies_data", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Discrepancies_data", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Discrepancies_data", "Detectabilty", NA, min = 1, max = 2), 
  checkboxGroupInput("inCheckboxGroup_Monitoring_Discrepancies_data", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Discrepancies_data <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Discrepancies_data))
      
      
    })



 title_Discrepancies_data= renderText({ input$Discrepancies_data })


 
    Area_1_Discrepancies_data <- reactive({ 0.5*as.numeric(A2_Discrepancies_data())*input$Prob_Discrepancies_data*sin(120)  }) 
 Area_2_Discrepancies_data <- reactive({ 0.5*as.numeric(A2_Discrepancies_data())*input$Det_Discrepancies_data*sin(120)  }) 

Area_3_Discrepancies_data <- reactive({ 0.5*input$Prob_Discrepancies_data*input$Det_Discrepancies_data*sin(120)  }) 
Area_4_Discrepancies_data <-  reactive({ 
  round((Area_1_Discrepancies_data()+Area_2_Discrepancies_data()+Area_3_Discrepancies_data()  ) /15.09589*100,
        digits = 0 )
           }) 
 
  renderPlot({
   
    

       Var1 <-as.numeric(A2_Discrepancies_data())
         Var2 <-input$Prob_Discrepancies_data
         Var3 <- input$Det_Discrepancies_data
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Discrepancies_data())
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Discrepancies_data()))=="NA", "Total Area",
                                  paste(round(Area_4_Discrepancies_data()))), cex = 1.6, col = "black")
   
   })
 
 
 
  A2_Discrepancies_data_Monitoring <- renderText({    
          Monitoring_Discrepancies_data <- input$inCheckboxGroup_Monitoring_Discrepancies_data
          })

```


### **2. Having missing source documents**
```{r echo=FALSE}
 
inputPanel(

    textInput("Missing_source_Documents", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Missing_source_Documents", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Missing_source_Documents", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Missing_source_Documents", "Detectabilty", NA, min = 1, max = 2),
  checkboxGroupInput("inCheckboxGroup_Monitoring_Missing_source_Documents", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Missing_source_Documents <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Missing_source_Documents))
      
      
    })



 title_Missing_source_Documents= renderText({ input$Missing_source_Documents })

 
   Area_1_Missing_source_Documents <- reactive({ 0.5*as.numeric(A2_Missing_source_Documents())*input$Prob_Missing_source_Documents*sin(120)  }) 
 Area_2_Missing_source_Documents <- reactive({ 0.5*as.numeric(A2_Discrepancies_data())*input$Det_Missing_source_Documents*sin(120)  }) 

Area_3_Missing_source_Documents <- reactive({ 0.5*input$Prob_Missing_source_Documents*input$Det_Missing_source_Documents*sin(120)  }) 
Area_4_Missing_source_Documents <-  reactive({ round(( Area_1_Missing_source_Documents()+Area_2_Missing_source_Documents()+Area_3_Missing_source_Documents()  ) /15.09589*100,
        digits = 0 )
           }) 
 
 renderPlot({
   
    
        Var1 <-as.numeric(A2_Missing_source_Documents())
         Var2 <-input$Prob_Missing_source_Documents
         Var3 <- input$Det_Missing_source_Documents
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Missing_source_Documents())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Missing_source_Documents()))=="NA", "Total Area",
                                  paste(round(Area_4_Missing_source_Documents()))), cex = 1.6, col = "black")
   })
 
   A2_Missing_source_Documents_Monitoring <- renderText({    
          Monitoring_Missing_source_Documents <- input$inCheckboxGroup_Monitoring_Missing_source_Documents
          })


```

### **3. Lack/Missing of document specifying location of source data**
```{r echo=FALSE}
 
inputPanel(

    textInput("Lack_document_location", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Lack_document_location", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Lack_document_location", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Lack_document_location", "Detectabilty", NA, min = 1, max = 2),
  checkboxGroupInput("inCheckboxGroup_Monitoring_Lack_document_location", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Lack_document_location <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Lack_document_location))
      
      
    })



 title_Lack_document_location= renderText({ input$Lack_document_location })


 
    Area_1_Lack_document_location <- reactive({ 0.5*as.numeric(A2_Lack_document_location())*input$Prob_Lack_document_location*sin(120)  }) 
 Area_2_Lack_document_location <- reactive({ 0.5*as.numeric(A2_Lack_document_location())*input$Det_Lack_document_location*sin(120)  }) 

Area_3_Lack_document_location <- reactive({ 0.5*input$Prob_Lack_document_location*input$Det_Lack_document_location*sin(120)  }) 
Area_4_Lack_document_location <-  reactive({ round(( Area_1_Lack_document_location()+Area_2_Lack_document_location()+Area_3_Lack_document_location()   ) /15.09589*100,
        digits = 0 )
          }) 
 
  renderPlot({
   
      
     Var1 <-as.numeric(A2_Lack_document_location())
         Var2 <-input$Prob_Lack_document_location
         Var3 <- input$Det_Lack_document_location
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Lack_document_location())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Lack_document_location()))=="NA", "Total Area",
                                  paste(round(Area_4_Lack_document_location()))), cex = 1.6, col = "black")
   })
 
    A2_Lack_document_location_Monitoring <- renderText({    
          Monitoring__Lack_document_location <- input$inCheckboxGroup_Monitoring_Lack_document_location
          })


```


```{r PDF_Source_Documentation, echo=FALSE}
 mainPanel( downloadButton(outputId = "download_Source_Documentation", label = "Download Source Documentation Report"))


    output$download_Source_Documentation <- downloadHandler(
   filename = function() { paste("Source Documentation", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(3,1))
         
         
       # 1st  
         
         
 title_Discrepancies_data= renderText({ input$Discrepancies_data })
    
   Area_1_Discrepancies_data <- reactive({ 0.5*as.numeric(A2_Discrepancies_data())*input$Prob_Discrepancies_data*sin(120)  }) 
 Area_2_Discrepancies_data <- reactive({ 0.5*as.numeric(A2_Discrepancies_data())*input$Det_Discrepancies_data*sin(120)  }) 

Area_3_Discrepancies_data <- reactive({ 0.5*input$Prob_Discrepancies_data*input$Det_Discrepancies_data*sin(120)  }) 
Area_4_Discrepancies_data <-  reactive({ Area_1_Discrepancies_data()+Area_2_Discrepancies_data()+Area_3_Discrepancies_data()  }) 

     
       Var1 <-as.numeric(A2_Discrepancies_data())
         Var2 <-input$Prob_Discrepancies_data
         Var3 <- input$Det_Discrepancies_data
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Discrepancies_data())
                              text(x = 0.5, y = 0.8, paste(round(Area_4_Discrepancies_data())), cex = 1.6, col = "black")

         # 2nd 
         
         title_Missing_source_Documents= renderText({ input$Missing_source_Documents })

   Area_1_Missing_source_Documents <- reactive({ 0.5*as.numeric(A2_Missing_source_Documents())*input$Prob_Missing_source_Documents*sin(120)  }) 
 Area_2_Missing_source_Documents <- reactive({ 0.5*as.numeric(A2_Discrepancies_data())*input$Det_Missing_source_Documents*sin(120)  }) 

Area_3_Missing_source_Documents <- reactive({ 0.5*input$Prob_Missing_source_Documents*input$Det_Missing_source_Documents*sin(120)  }) 
Area_4_Missing_source_Documents <-  reactive({ Area_1_Missing_source_Documents()+Area_2_Missing_source_Documents()+Area_3_Missing_source_Documents()  }) 

     
       Var1 <-as.numeric(A2_Missing_source_Documents())
         Var2 <-input$Prob_Missing_source_Documents
         Var3 <- input$Det_Missing_source_Documents
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Missing_source_Documents())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_Missing_source_Documents())), cex = 1.6, col = "black")

# 3rd  
      title_Lack_document_location= renderText({ input$Lack_document_location })

       Area_1_Lack_document_location <- reactive({ 0.5*as.numeric(A2_Lack_document_location())*input$Prob_Lack_document_location*sin(120)  }) 
 Area_2_Lack_document_location <- reactive({ 0.5*as.numeric(A2_Lack_document_location())*input$Det_Lack_document_location*sin(120)  }) 

Area_3_Lack_document_location <- reactive({ 0.5*input$Prob_Lack_document_location*input$Det_Lack_document_location*sin(120)  }) 
Area_4_Lack_document_location <-  reactive({ Area_1_Lack_document_location()+Area_2_Lack_document_location()+Area_3_Lack_document_location()  }) 

     
       Var1 <-as.numeric(A2_Lack_document_location())
         Var2 <-input$Prob_Lack_document_location
         Var3 <- input$Det_Lack_document_location
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Lack_document_location())                           
                      text(x = 0.5, y = 0.8, paste(round(Area_4_Lack_document_location())), cex = 1.6, col = "black")

   
         
         dev.off()
   }
  )

```



## **`r colorize("Qualification/Training", "mediumblue")`**
### **1. Incomplete training documentation** 
```{r echo=FALSE}
 
inputPanel(

    textInput("incomplete_training_documentation", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_incomplete_training_documentation", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_incomplete_training_documentation", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_incomplete_training_documentation", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_incomplete_training_documentation", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))
  

         )



  A2_incomplete_training_documentation <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_incomplete_training_documentation))
      
      
    })



 title_incomplete_training_documentation= renderText({ input$incomplete_training_documentation })

 
   Area_1_incomplete_training_documentation <- reactive({ 0.5*as.numeric(A2_incomplete_training_documentation())*input$Prob_incomplete_training_documentation*sin(120)  }) 
 Area_2_incomplete_training_documentation <- reactive({ 0.5*as.numeric(A2_incomplete_training_documentation())*input$Det_incomplete_training_documentation*sin(120)  }) 

Area_3_incomplete_training_documentation <- reactive({ 0.5*input$Prob_incomplete_training_documentation*input$Det_incomplete_training_documentation*sin(120)  }) 
Area_4_incomplete_training_documentation <-  reactive({ round((
  
 Area_1_incomplete_training_documentation()+Area_2_incomplete_training_documentation()+Area_3_incomplete_training_documentation()   ) /15.09589*100,
        digits = 0 )
          }) 
 
 renderPlot({
   
    
       Var1 <-as.numeric(A2_incomplete_training_documentation())
         Var2 <-input$Prob_incomplete_training_documentation
         Var3 <- input$Det_incomplete_training_documentation
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_incomplete_training_documentation())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_incomplete_training_documentation()))=="NA", "Total Area",
                                  paste(round(Area_4_incomplete_training_documentation()))), cex = 1.6, col = "black")
   })
 
  
  A2_incomplete_training_documentation_Monitoring <- renderText({    
          Monitoring_incomplete_training_documentation <- input$inCheckboxGroup_Monitoring_incomplete_training_documentation
          })

```


### **2. lack of training of study personnel on trial related procedures**
```{r echo=FALSE}

inputPanel(

    textInput("lack_training_personnel_procedure", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_lack_training_personnel_procedure", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_lack_training_personnel_procedure", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_lack_training_personnel_procedure", "Detectabilty", NA, min = 1, max = 2),
   checkboxGroupInput("inCheckboxGroup_Monitoring_lack_training_personnel_procedure", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_lack_training_personnel_procedure <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_lack_training_personnel_procedure))
      
      
    })



 title_lack_training_personnel_procedure= renderText({ input$lack_training_personnel_procedure })

   Area_1_lack_training_personnel_procedure <- reactive({ 0.5*as.numeric(A2_lack_training_personnel_procedure())*input$Prob_lack_training_personnel_procedure*sin(120)  }) 
 Area_2_lack_training_personnel_procedure <- reactive({ 0.5*as.numeric(A2_lack_training_personnel_procedure())*input$Det_lack_training_personnel_procedure*sin(120)  }) 

Area_3_lack_training_personnel_procedure <- reactive({ 0.5*input$Prob_lack_training_personnel_procedure*input$Det_lack_training_personnel_procedure*sin(120)  }) 
Area_4_lack_training_personnel_procedure <-  reactive({ 
 round(( Area_1_lack_training_personnel_procedure()+Area_2_lack_training_personnel_procedure()+Area_3_lack_training_personnel_procedure()   ) /15.09589*100,
        digits = 0 )
          }) 
 
 
 renderPlot({
   
        Var1 <-as.numeric(A2_lack_training_personnel_procedure())
         Var2 <-input$Prob_lack_training_personnel_procedure
         Var3 <- input$Det_lack_training_personnel_procedure
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_lack_training_personnel_procedure())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_lack_training_personnel_procedure()))=="NA", "Total Area",
                                  paste(round(Area_4_lack_training_personnel_procedure()))), cex = 1.6, col = "black")
   })

   A2_lack_training_personnel_procedure_Monitoring <- renderText({    
          Monitoring_lack_training_personnel_procedure <- input$inCheckboxGroup_Monitoring_lack_training_personnel_procedure
          })

```

```{r PDF_Qualification/Training, echo=FALSE}

 mainPanel( downloadButton(outputId = "download_Incomplete_training_documentation", label = "Download Incomplete Training Documentation Report"))


    output$download_Incomplete_training_documentation <- downloadHandler(
   filename = function() { paste("Essential Document", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(2,1))

         # 1st
         
          title_incomplete_training_documentation= renderText({ input$incomplete_training_documentation })


   
    
   Area_1_incomplete_training_documentation <- reactive({ 0.5*as.numeric(A2_incomplete_training_documentation())*input$Prob_incomplete_training_documentation*sin(120)  }) 
 Area_2_incomplete_training_documentation <- reactive({ 0.5*as.numeric(A2_incomplete_training_documentation())*input$Det_incomplete_training_documentation*sin(120)  }) 

Area_3_incomplete_training_documentation <- reactive({ 0.5*input$Prob_incomplete_training_documentation*input$Det_incomplete_training_documentation*sin(120)  }) 
Area_4_incomplete_training_documentation <-  reactive({ Area_1_incomplete_training_documentation()+Area_2_incomplete_training_documentation()+Area_3_incomplete_training_documentation()  }) 

     
       Var1 <-as.numeric(A2_incomplete_training_documentation())
         Var2 <-input$Prob_incomplete_training_documentation
         Var3 <- input$Det_incomplete_training_documentation
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=paste("1. Incomplete training documentation", title_incomplete_training_documentation(), sep="-"   )  )                           
                         text(x = 0.5, y = 0.8, paste(round(Area_4_incomplete_training_documentation())), cex = 1.6, col = "black")

         
         # 2nd 
          title_lack_training_personnel_procedure= renderText({ input$lack_training_personnel_procedure })

 
   
   Area_1_lack_training_personnel_procedure <- reactive({ 0.5*as.numeric(A2_lack_training_personnel_procedure())*input$Prob_lack_training_personnel_procedure*sin(120)  }) 
 Area_2_lack_training_personnel_procedure <- reactive({ 0.5*as.numeric(A2_lack_training_personnel_procedure())*input$Det_lack_training_personnel_procedure*sin(120)  }) 

Area_3_lack_training_personnel_procedure <- reactive({ 0.5*input$Prob_lack_training_personnel_procedure*input$Det_lack_training_personnel_procedure*sin(120)  }) 
Area_4_lack_training_personnel_procedure <-  reactive({ 
  Area_1_lack_training_personnel_procedure()+Area_2_lack_training_personnel_procedure()+Area_3_lack_training_personnel_procedure()  }) 

     
     
       Var1 <-as.numeric(A2_lack_training_personnel_procedure())
         Var2 <-input$Prob_lack_training_personnel_procedure
         Var3 <- input$Det_lack_training_personnel_procedure
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title= "2. lack of training of study personnel on trial related procedures"  )                           
                            text(x = 0.5, y = 0.8, paste(round(Area_4_lack_training_personnel_procedure())), cex = 1.6, col = "black")
                            text(x=0, y=-1, title_lack_training_personnel_procedure(),cex = 1.3, col = "black" )


         

        dev.off()
   }
  )


```


## **`r colorize("Organization and personnel", "mediumblue")`**

### **1. Incomplete site personnel signature log**
```{r echo=FALSE}
 
inputPanel(

    textInput("signature_log", "such as ", ""),

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_signature_log", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_signature_log", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_signature_log", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Technique_signature_log", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_signature_log <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_signature_log))
        })


 title_signature_log= renderText({ input$signature_log })

      Area_1_signature_log <- reactive({ 0.5*as.numeric(A2_signature_log())*input$Prob_signature_log*sin(120)  }) 
 Area_2_signature_log <- reactive({ 0.5*as.numeric(A2_signature_log())*input$Det_signature_log*sin(120)  }) 

Area_3_signature_log <- reactive({ 0.5*input$Prob_signature_log*input$Det_signature_log*sin(120)  }) 
Area_4_signature_log <-  reactive({ round(( Area_1_signature_log()+Area_2_signature_log()+Area_3_signature_log()  ) /15.09589*100,
        digits = 0 )
           }) 
 
 renderPlot({
   
         Var1 <-as.numeric(A2_signature_log())
         Var2 <-input$Prob_signature_log
         Var3 <- input$Det_signature_log
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_signature_log())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_signature_log()))=="NA", "Total Area",
                                  paste(round(Area_4_signature_log()))), cex = 1.6, col = "black")
   })

 
 
   A2_signature_log_Monitoring <- renderText({    
      
    Monitoring_signature_log <- input$inCheckboxGroup_Monitoring_Technique_signature_log
      
      
    })
```


### **2. Tasks performed by unauthorized staff**
```{r echo=FALSE}
 
inputPanel(

    textInput("tasks_staff", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_tasks_staff", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_tasks_staff", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_tasks_staff", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Technique_tasks_staff", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_tasks_staff <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_tasks_staff))
      
      
    })



 title_tasks_staff= renderText({ input$tasks_staff })


        Area_1_tasks_staff <- reactive({ 0.5*as.numeric(A2_tasks_staff())*input$Prob_tasks_staff*sin(120)  }) 
 Area_2_tasks_staff <- reactive({ 0.5*as.numeric(A2_tasks_staff())*input$Det_tasks_staff*sin(120)  }) 

Area_3_tasks_staff <- reactive({ 0.5*input$Prob_tasks_staff*input$Det_tasks_staff*sin(120)  }) 
Area_4_tasks_staff <-  reactive({ round((Area_1_tasks_staff()+Area_2_tasks_staff()+Area_3_tasks_staff()  ) /15.09589*100,
        digits = 0 )
           })
 
  renderPlot({
   

       Var1 <-as.numeric(A2_tasks_staff())
         Var2 <-input$Prob_tasks_staff
         Var3 <- input$Det_tasks_staff
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_tasks_staff())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_tasks_staff()))=="NA", "Total Area",
                                  paste(round(Area_4_tasks_staff()))), cex = 1.6, col = "black")
   })
 
   A2_tasks_staff_Monitoring <- renderText({    
      
    Monitoring_tasks_staff <- input$inCheckboxGroup_Monitoring_Technique_tasks_staff
      
      
    })

```


```{r PDF_download_Organization_personnel,echo=FALSE}


 mainPanel( downloadButton(outputId = "download_Organization_personnel", label = "Download Organization and personnel Report"))


    output$download_Organization_personnel <- downloadHandler(
   filename = function() { paste("Organization and personnel", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(2,1))

         # 1st
         
 title_signature_log= renderText({ input$signature_log })
  
   
       Area_1_signature_log <- reactive({ 0.5*as.numeric(A2_signature_log())*input$Prob_signature_log*sin(120)  }) 
 Area_2_signature_log <- reactive({ 0.5*as.numeric(A2_signature_log())*input$Det_signature_log*sin(120)  }) 

Area_3_signature_log <- reactive({ 0.5*input$Prob_signature_log*input$Det_signature_log*sin(120)  }) 
Area_4_signature_log <-  reactive({ Area_1_signature_log()+Area_2_signature_log()+Area_3_signature_log()  }) 

       Var1 <-as.numeric(A2_signature_log())
         Var2 <-input$Prob_signature_log
         Var3 <- input$Det_signature_log
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_signature_log())                           
                        text(x = 0.5, y = 0.8, paste(round(Area_4_signature_log())), cex = 1.6, col = "black")

         
         
         
         
         
         # 2nd 
         
          title_tasks_staff= renderText({ input$tasks_staff })

          Area_1_tasks_staff <- reactive({ 0.5*as.numeric(A2_tasks_staff())*input$Prob_tasks_staff*sin(120)  }) 
 Area_2_tasks_staff <- reactive({ 0.5*as.numeric(A2_tasks_staff())*input$Det_tasks_staff*sin(120)  }) 

Area_3_tasks_staff <- reactive({ 0.5*input$Prob_tasks_staff*input$Det_tasks_staff*sin(120)  }) 
Area_4_tasks_staff <-  reactive({ round(( Area_1_tasks_staff()+Area_2_tasks_staff()+Area_3_tasks_staff()  ) /15.09589*100,
        digits = 0 )
           }) 

   
     
       Var1 <-as.numeric(A2_tasks_staff())
         Var2 <-input$Prob_tasks_staff
         Var3 <- input$Det_tasks_staff
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_tasks_staff())                           
                           text(x = 0.5, y = 0.8, paste(round(Area_4_tasks_staff())), cex = 1.6, col = "black")

         
        dev.off()
   }
  )



```

 
## **`r colorize("Contract/Agreements", "mediumblue")`**
### **1. Incomplete contracts in place**
```{r echo=FALSE}
 
inputPanel(

    textInput("contract_incomplete", "such as ", ""),

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_contract_incomplete", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

      #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_contract_incomplete", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_contract_incomplete", "Detectabilty", NA, min = 1, max = 2), 
  
    checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_contract_incomplete", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_contract_incomplete <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_contract_incomplete))
      
      
    })



 title_contract_incomplete= renderText({ input$contract_incomplete })


 
        Area_1_contract_incomplete <- reactive({ 0.5*as.numeric(A2_contract_incomplete())*input$Prob_contract_incomplete*sin(120)  }) 
 Area_2_contract_incomplete <- reactive({ 0.5*as.numeric(A2_contract_incomplete())*input$Det_contract_incomplete*sin(120)  }) 

Area_3_contract_incomplete <- reactive({ 0.5*input$Prob_contract_incomplete*input$Det_contract_incomplete*sin(120)  }) 
Area_4_contract_incomplete <-  reactive({round(( Area_1_contract_incomplete()+Area_2_contract_incomplete()+Area_3_contract_incomplete()  ) /15.09589*100,
        digits = 0 )
           }) 
 
  renderPlot({
   
   
     Var1 <-as.numeric(A2_contract_incomplete())
         Var2 <-input$Prob_contract_incomplete
         Var3 <- input$Det_contract_incomplete
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_contract_incomplete())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_contract_incomplete()))=="NA", "Total Area",
                                  paste(round(Area_4_contract_incomplete()))), cex = 1.6, col = "black")
   })
  A2_contract_incomplete_Monitoring <- renderText({    
      
    Monitoring_contract_incomplete <- input$inCheckboxGroup_Monitoring_Techniques_contract_incomplete
      
      
    })
 
 
```

### **2. lack of consistency between contract and protocol**
```{r echo=FALSE}
 
inputPanel(

    textInput("contract_protocol_consistent", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_contract_protocol_consistent", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_contract_protocol_consistent", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_contract_protocol_consistent", "Detectabilty", NA, min = 1, max = 2),
  checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_contract_protocol_consistent", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_contract_protocol_consistent <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_contract_protocol_consistent))
      
      
    })



 title_contract_protocol_consistent= renderText({ input$contract_protocol_consistent })

  Area_1_protocol_consistent <- reactive({ 0.5*as.numeric(A2_contract_protocol_consistent())*input$Prob_contract_protocol_consistent*sin(120)  }) 
 Area_2_protocol_consistent <- reactive({ 0.5*as.numeric(A2_contract_protocol_consistent())*input$Det_contract_protocol_consistent*sin(120)  }) 

Area_3_protocol_consistent <- reactive({ 0.5*input$Prob_contract_protocol_consistent*input$Det_contract_protocol_consistent*sin(120)  }) 
Area_4_protocol_consistent <-  reactive({ round(( Area_1_protocol_consistent()+Area_2_protocol_consistent()+Area_3_protocol_consistent()  ) /15.09589*100,
        digits = 0 )
           })
 
 
 renderPlot({
   
       Var1 <-as.numeric(A2_contract_protocol_consistent())
         Var2 <-input$Prob_contract_protocol_consistent
         Var3 <- input$Det_contract_protocol_consistent
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_contract_protocol_consistent())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_protocol_consistent()))=="NA", "Total Area",
                                  paste(round(Area_4_protocol_consistent()))), cex = 1.6, col = "black")
   })
 
   A2_contract_protocol_consistent_Monitoring <- renderText({    
      
    Monitoring_contract_protocol_consistent <- input$inCheckboxGroup_Monitoring_Techniques_contract_protocol_consistent
      
      
    })
 

```


### **3. Responsibilities not clearly identified**
```{r echo=FALSE}
 
inputPanel(

    textInput("Responsibilities_ident", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Responsibilities_ident", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Responsibilities_ident", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Responsibilities_ident", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Responsibilities_ident", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Responsibilities_ident <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Responsibilities_ident))
      
      
    })



 title_Responsibilities_ident= renderText({ input$Responsibilities_ident })

    Area_1_Responsibilities_ident <- reactive({ 0.5*as.numeric(A2_Responsibilities_ident())*input$Prob_Responsibilities_ident*sin(120)  }) 
 Area_2_Responsibilities_ident <- reactive({ 0.5*as.numeric(A2_Responsibilities_ident())*input$Det_Responsibilities_ident*sin(120)  }) 

Area_3_Responsibilities_ident <- reactive({ 0.5*input$Prob_Responsibilities_ident*input$Det_Responsibilities_ident*sin(120)  }) 
Area_4_Responsibilities_ident <-  reactive({ round(( Area_1_Responsibilities_ident()+Area_2_Responsibilities_ident()+Area_3_Responsibilities_ident()  ) /15.09589*100,
        digits = 0 )
           }) 
 
  renderPlot({
   

       Var1 <-as.numeric(A2_Responsibilities_ident())
         Var2 <-input$Prob_Responsibilities_ident
         Var3 <- input$Det_Responsibilities_ident
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Responsibilities_ident())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Responsibilities_ident()))=="NA", "Total Area",
                                  paste(round(Area_4_Responsibilities_ident()))), cex = 1.6, col = "black")
   })
 
 
   A2_Responsibilities_ident_Monitoring <- renderText({    
      
    Monitoring_Responsibilities_ident <- input$inCheckboxGroup_Monitoring_Techniques_Responsibilities_ident
      
      
    })

```

```{r PDF_Contracts_Agreements, echo=FALSE}

 mainPanel( downloadButton(outputId = "download_Contract_Agreements", label = "Download Contract/Agreements Report"))


    output$download_Contract_Agreements <- downloadHandler(
   filename = function() { paste("Contract/Agreements", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(2,1))

         # 1st
         
 title_contract_incomplete= renderText({ input$contract_incomplete })


   
   
       Area_1_contract_incomplete <- reactive({ 0.5*as.numeric(A2_contract_incomplete())*input$Prob_contract_incomplete*sin(120)  }) 
 Area_2_contract_incomplete <- reactive({ 0.5*as.numeric(A2_contract_incomplete())*input$Det_contract_incomplete*sin(120)  }) 

Area_3_contract_incomplete <- reactive({ 0.5*input$Prob_contract_incomplete*input$Det_contract_incomplete*sin(120)  }) 
Area_4_contract_incomplete <-  reactive({ Area_1_contract_incomplete()+Area_2_contract_incomplete()+Area_3_contract_incomplete()  }) 

     
       Var1 <-as.numeric(A2_contract_incomplete())
         Var2 <-input$Prob_contract_incomplete
         Var3 <- input$Det_contract_incomplete
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_contract_incomplete())                           
                           text(x = 0.5, y = 0.8, paste(round(Area_4_contract_incomplete())), cex = 1.6, col = "black")

         
         
         
         
       #  2nd 
         
 title_contract_protocol_consistent= renderText({ input$contract_protocol_consistent })


   
     Area_1_protocol_consistent <- reactive({ 0.5*as.numeric(A2_contract_protocol_consistent())*input$Prob_contract_protocol_consistent*sin(120)  }) 
 Area_2_protocol_consistent <- reactive({ 0.5*as.numeric(A2_contract_protocol_consistent())*input$Det_contract_protocol_consistent*sin(120)  }) 

Area_3_protocol_consistent <- reactive({ 0.5*input$Prob_contract_protocol_consistent*input$Det_contract_protocol_consistent*sin(120)  }) 
Area_4_protocol_consistent <-  reactive({ Area_1_protocol_consistent()+Area_2_protocol_consistent()+Area_3_protocol_consistent()  }) 
     
       Var1 <-as.numeric(A2_contract_protocol_consistent())
         Var2 <-input$Prob_contract_protocol_consistent
         Var3 <- input$Det_contract_protocol_consistent
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_contract_protocol_consistent())                           
                              text(x = 0.5, y = 0.8, paste(round(Area_4_protocol_consistent())), cex = 1.6, col = "black")

         
         
         
         
       #  3rd
         
         
 title_Responsibilities_ident= renderText({ input$Responsibilities_ident })

 
    Area_1_Responsibilities_ident <- reactive({ 0.5*as.numeric(A2_Responsibilities_ident())*input$Prob_Responsibilities_ident*sin(120)  }) 
 Area_2_Responsibilities_ident <- reactive({ 0.5*as.numeric(A2_Responsibilities_ident())*input$Det_Responsibilities_ident*sin(120)  }) 

Area_3_Responsibilities_ident <- reactive({ 0.5*input$Prob_Responsibilities_ident*input$Det_Responsibilities_ident*sin(120)  }) 
Area_4_Responsibilities_ident <-  reactive({ Area_1_Responsibilities_ident()+Area_2_Responsibilities_ident()+Area_3_Responsibilities_ident()  }) 

     
     
       Var1 <-as.numeric(A2_Responsibilities_ident())
         Var2 <-input$Prob_Responsibilities_ident
         Var3 <- input$Det_Responsibilities_ident
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Responsibilities_ident())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_Responsibilities_ident())), cex = 1.6, col = "black")

         
                dev.off()
   }
  )

```



## **`r colorize("Data management", "mediumblue")`**
### **1. System for reporting protocol violations**
```{r echo=FALSE}
 
inputPanel(

    textInput("Inappropriate_report_protocol", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Inappropriate_report_protocol", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Inappropriate_report_protocol", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Inappropriate_report_protocol", "Detectabilty", NA, min = 1, max = 2), 
    checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Inappropriate_report_protocol", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))


         )



  A2_Inappropriate_report_protocol <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Inappropriate_report_protocol))
      
      
    })



 title_Inappropriate_report_protocol= renderText({ input$Inappropriate_report_protocol })


 
      Area_1_Inappropriate_report_protocol <- reactive({ 0.5*as.numeric(A2_Inappropriate_report_protocol())*input$Prob_Inappropriate_report_protocol*sin(120)  }) 
 Area_2_Inappropriate_report_protocol <- reactive({ 0.5*as.numeric(A2_Inappropriate_report_protocol())*input$Det_Inappropriate_report_protocol*sin(120)  }) 

Area_3_Inappropriate_report_protocol <- reactive({ 0.5*input$Prob_Inappropriate_report_protocol*input$Det_Inappropriate_report_protocol*sin(120)  }) 
Area_4_Inappropriate_report_protocol<-  reactive({ round(( Area_1_Inappropriate_report_protocol()+Area_2_Inappropriate_report_protocol()+Area_3_Inappropriate_report_protocol()  ) /15.09589*100,
        digits = 0 )
           }) 

  renderPlot({
   
       Var1 <-as.numeric(A2_Inappropriate_report_protocol())
         Var2 <-input$Prob_Inappropriate_report_protocol
         Var3 <- input$Det_Inappropriate_report_protocol
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inappropriate_report_protocol())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Inappropriate_report_protocol()))=="NA", "Total Area",
                                  paste(round(Area_4_Inappropriate_report_protocol()))), cex = 1.6, col = "black")
   })
 
 A2_report_protocol_Monitoring <- renderText({    
      
    Monitoring_report_protocol <- input$inCheckboxGroup_Monitoring_Techniques_Inappropriate_report_protocol
      
      
    })
  
 

```

### **2. Having late laboratory report submission to the site**
```{r echo=FALSE}
 
inputPanel(

    textInput("lab_report_submission", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_lab_report_submission", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_lab_report_submission", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_lab_report_submission", "Detectabilty", NA, min = 1, max = 2), 
    checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_lab_report_submission", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))


         )



  A2_lab_report_submission<- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_lab_report_submission))
      
      
    })



 title_lab_report_submission= renderText({ input$lab_report_submission })

 
    Area_1_lab_report_submission <- reactive({ 0.5*as.numeric(A2_lab_report_submission())*input$Prob_lab_report_submission*sin(120)  }) 
 Area_2_lab_report_submission <- reactive({ 0.5*as.numeric(A2_lab_report_submission())*input$Det_lab_report_submission*sin(120)  }) 

Area_3_lab_report_submission <- reactive({ 0.5*input$Prob_lab_report_submission*input$Det_lab_report_submission*sin(120)  }) 
Area_4_lab_report_submission <-  reactive({ round(( Area_1_lab_report_submission()+Area_2_lab_report_submission()+Area_3_lab_report_submission()  ) /15.09589*100,
        digits = 0 )
           })
 
 renderPlot({
   
   
           Var1 <-as.numeric(A2_lab_report_submission())
         Var2 <-input$Prob_lab_report_submission
         Var3 <- input$Det_lab_report_submission
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_lab_report_submission())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_lab_report_submission()))=="NA", "Total Area",
                                  paste(round(Area_4_lab_report_submission()))), cex = 1.6, col = "black")
   })
 
 A2_lab_report_submission_Monitoring <- renderText({    
      
    Monitoring_lab_report_submission <- input$inCheckboxGroup_Monitoring_Techniques_lab_report_submission
      
      
    })
  
 

```


### **3. Decisions made by the DMSB and their communication to the site(Delay, etc)**

```{r echo=FALSE}
 
inputPanel(

    textInput("DEcision_DMSB_site", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_DEcision_DMSB_site", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_DEcision_DMSB_site", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_DEcision_DMSB_site", "Detectabilty", NA, min = 1, max = 2), 
    checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_DEcision_DMSB_site", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))


         )



  A2_DEcision_DMSB_site <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_DEcision_DMSB_site))
      
      
    })



 title_DEcision_DMSB_site= renderText({ input$DEcision_DMSB_site })

 
 
     
       Area_1_DEcision_DMSB_site <- reactive({ 0.5*as.numeric(A2_DEcision_DMSB_site())*input$Prob_DEcision_DMSB_site*sin(120)  }) 
 Area_2_DEcision_DMSB_site <- reactive({ 0.5*as.numeric(A2_DEcision_DMSB_site())*input$Det_DEcision_DMSB_site*sin(120)  }) 

Area_3_DEcision_DMSB_site <- reactive({ 0.5*input$Prob_DEcision_DMSB_site*input$Det_DEcision_DMSB_site*sin(120)  }) 
Area_4_DEcision_DMSB_site <-  reactive({  round((Area_1_DEcision_DMSB_site()+Area_2_DEcision_DMSB_site()+Area_3_DEcision_DMSB_site()  ) /15.09589*100,
        digits = 0 )
           }) 
 
 renderPlot({
   
 
Var1 <-as.numeric(A2_DEcision_DMSB_site())
         Var2 <-input$Prob_DEcision_DMSB_site
         Var3 <- input$Det_DEcision_DMSB_site
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_DEcision_DMSB_site())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_DEcision_DMSB_site()))=="NA", "Total Area",
                                  paste(round(Area_4_DEcision_DMSB_site()))), cex = 1.6, col = "black")
   })
 
 A2_DEcision_DMSB_site_Monitoring <- renderText({    
      
       Monitoring_DEcision_DMSB_site <- input$inCheckboxGroup_Monitoring_Techniques_DEcision_DMSB_site
      
    })
  
 

```


```{r PDF_Data_managment, echo=FALSE}

mainPanel( downloadButton(outputId = "download_Data_management", label = "Download Data Managment Report"))


    output$download_Data_management <- downloadHandler(
   filename = function() { paste("Data Management", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(2,1))

         # 1st
        
         
         

 title_Inappropriate_report_protocol= renderText({ input$Inappropriate_report_protocol })
     Area_1_Inappropriate_report_protocol <- reactive({ 0.5*as.numeric(A2_Inappropriate_report_protocol())*input$Prob_Inappropriate_report_protocol*sin(120)  }) 
 Area_2_Inappropriate_report_protocol <- reactive({ 0.5*as.numeric(A2_Inappropriate_report_protocol())*input$Det_Inappropriate_report_protocol*sin(120)  }) 

Area_3_Inappropriate_report_protocol <- reactive({ 0.5*input$Prob_Inappropriate_report_protocol*input$Det_Inappropriate_report_protocol*sin(120)  }) 
Area_4_Inappropriate_report_protocol<-  reactive({ Area_1_Inappropriate_report_protocol()+Area_2_Inappropriate_report_protocol()+Area_3_Inappropriate_report_protocol()  }) 

     
       Var1 <-as.numeric(A2_Inappropriate_report_protocol())
         Var2 <-input$Prob_Inappropriate_report_protocol
         Var3 <- input$Det_Inappropriate_report_protocol
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inappropriate_report_protocol())                           
                              text(x = 0.5, y = 0.8, paste(round(Area_4_Inappropriate_report_protocol())), cex = 1.6, col = "black")

         
         
         
        #2nd
         
         
         

 title_lab_report_submission= renderText({ input$lab_report_submission })

       Area_1_lab_report_submission <- reactive({ 0.5*as.numeric(A2_lab_report_submission())*input$Prob_lab_report_submission*sin(120)  }) 
 Area_2_lab_report_submission <- reactive({ 0.5*as.numeric(A2_lab_report_submission())*input$Det_lab_report_submission*sin(120)  }) 

Area_3_lab_report_submission <- reactive({ 0.5*input$Prob_lab_report_submission*input$Det_lab_report_submission*sin(120)  }) 
Area_4_lab_report_submission <-  reactive({ Area_1_lab_report_submission()+Area_2_lab_report_submission()+Area_3_lab_report_submission()  }) 

     
     
       Var1 <-as.numeric(A2_lab_report_submission())
         Var2 <-input$Prob_lab_report_submission
         Var3 <- input$Det_lab_report_submission
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_lab_report_submission())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_lab_report_submission())), cex = 1.6, col = "black")

         
         
         
         
         
         
         #3rd
         
         
         
 title_DEcision_DMSB_site= renderText({ input$DEcision_DMSB_site })

     
       Area_1_DEcision_DMSB_site <- reactive({ 0.5*as.numeric(A2_DEcision_DMSB_site())*input$Prob_DEcision_DMSB_site*sin(120)  }) 
 Area_2_DEcision_DMSB_site <- reactive({ 0.5*as.numeric(A2_DEcision_DMSB_site())*input$Det_DEcision_DMSB_site*sin(120)  }) 

Area_3_DEcision_DMSB_site <- reactive({ 0.5*input$Prob_DEcision_DMSB_site*input$Det_DEcision_DMSB_site*sin(120)  }) 
Area_4_DEcision_DMSB_site <-  reactive({ Area_1_DEcision_DMSB_site()+Area_2_DEcision_DMSB_site()+Area_3_DEcision_DMSB_site()  }) 
       Var1 <-as.numeric(A2_DEcision_DMSB_site())
         Var2 <-input$Prob_DEcision_DMSB_site
         Var3 <- input$Det_DEcision_DMSB_site
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_DEcision_DMSB_site())                           
                                    text(x = 0.5, y = 0.8, paste(round(Area_4_DEcision_DMSB_site())), cex = 1.6, col = "black")

         
         
         
                        dev.off()
   }
  )
```

## **`r colorize("Monitoring", "mediumblue")`**

### **1. Risk of not Identifying number of deficiencies on site by the Monitor**
```{r echo=FALSE}
 
inputPanel(

    textInput("Monitor_number_defici_site", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Monitor_number_defici_site", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Monitor_number_defici_site", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Monitor_number_defici_site", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Monitor_number_defici_site", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Monitor_number_defici_site <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Monitor_number_defici_site))
      
      
    })



 title_Monitor_number_defici_site= renderText({ input$Monitor_number_defici_site })

 
 
  Area_1_Monitor_number_defici_site <- reactive({ 0.5*as.numeric(A2_Monitor_number_defici_site())*input$Prob_Monitor_number_defici_site*sin(120)  }) 
 Area_2_Monitor_number_defici_site <- reactive({ 0.5*as.numeric(A2_Monitor_number_defici_site())*input$Det_Monitor_number_defici_site*sin(120)  }) 

Area_3_Monitor_number_defici_site <- reactive({ 0.5*input$Prob_Monitor_number_defici_site*input$Det_Monitor_number_defici_site*sin(120)  }) 
Area_4_Monitor_number_defici_site <-  reactive({ Area_1_Monitor_number_defici_site()+Area_2_Monitor_number_defici_site()+Area_3_Monitor_number_defici_site()  }) 

 renderPlot({
   
          Var1 <-as.numeric(A2_Monitor_number_defici_site())
         Var2 <-input$Prob_Monitor_number_defici_site
         Var3 <- input$Det_Monitor_number_defici_site
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Monitor_number_defici_site())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Monitor_number_defici_site()))=="NA", "Total Area",
                                  paste(round(Area_4_Monitor_number_defici_site()))), cex = 1.6, col = "black")
   })

 
 A2_Monitor_number_defici_site_Monitoring <- renderText({    
      
    Monitoring_Monitor_number_defici_site <- input$inCheckboxGroup_Monitoring_Techniques_Monitor_number_defici_site
      
      
    })
```

### **2. having unclear escalation process to resolve issues identified by monitor**
```{r echo=FALSE}
 
inputPanel(

    textInput("escalation_process_monitor", "such as ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_escalation_process_monitor", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_escalation_process_monitor", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_escalation_process_monitor", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_escalation_process_monitor", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_escalation_process_monitor <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_escalation_process_monitor))
      
      
    })



 title_escalation_process_monitor= renderText({ input$escalation_process_monitor })

 
  Area_1_escalation_process_monitor <- reactive({ 0.5*as.numeric(A2_escalation_process_monitor())*input$Prob_escalation_process_monitor*sin(120)  }) 
 Area_2_escalation_process_monitor<- reactive({ 0.5*as.numeric(A2_escalation_process_monitor())*input$Det_escalation_process_monitor*sin(120)  }) 

Area_3_escalation_process_monitor <- reactive({ 0.5*input$Prob_escalation_process_monitor*input$Det_escalation_process_monitor*sin(120)  }) 
Area_4_escalation_process_monitor <-  reactive({ round(( Area_1_escalation_process_monitor()+Area_2_escalation_process_monitor()+Area_3_escalation_process_monitor()  ) /15.09589*100,
        digits = 0 )
           }) 

 renderPlot({
   
             Var1 <-as.numeric(A2_escalation_process_monitor())
         Var2 <-input$Prob_escalation_process_monitor
         Var3 <- input$Det_escalation_process_monitor
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_escalation_process_monitor())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_escalation_process_monitor()))=="NA", "Total Area",
                                  paste(round(Area_4_escalation_process_monitor()))), cex = 1.6, col = "black")
   })
 
 A2_escalation_process_monitor_Monitoring <- renderText({    
      
    Monitoring_escalation_process_monitor <- input$inCheckboxGroup_Monitoring_Techniques_escalation_process_monitor
      
      
    })

```

### **3. Monitor not following monitoring plan**
```{r echo=FALSE}
 
inputPanel(

    textInput("Monitoring_plan_follow", "for any reason ", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Monitoring_plan_follow", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Monitoring_plan_follow", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Monitoring_plan_follow", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Monitoring_plan_follow", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Monitoring_plan_follow <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Monitoring_plan_follow))
      
      
    })



 title_Monitoring_plan_follow= renderText({ input$Monitoring_plan_follow })

   Area_1_Monitoring_plan_follow <- reactive({ 0.5*as.numeric(A2_Monitoring_plan_follow())*input$Prob_Monitoring_plan_follow*sin(120)  }) 
 Area_2_Monitoring_plan_follow <- reactive({ 0.5*as.numeric(A2_Monitoring_plan_follow())*input$Det_Monitoring_plan_follow*sin(120)  }) 

Area_3_Monitoring_plan_follow <- reactive({ 0.5*input$Prob_Monitoring_plan_follow*input$Det_Monitoring_plan_follow*sin(120)  }) 
Area_4_Monitoring_plan_follow <-  reactive({ round(( Area_1_Monitoring_plan_follow()+Area_2_Monitoring_plan_follow()+Area_3_Monitoring_plan_follow()  ) /15.09589*100,
        digits = 0 )
            }) 

 renderPlot({
   
         Var1 <-as.numeric(A2_Monitoring_plan_follow())
         Var2 <-input$Prob_Monitoring_plan_follow
         Var3 <- input$Det_Monitoring_plan_follow
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Monitoring_plan_follow())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Monitoring_plan_follow()))=="NA", "Total Area",
                                  paste(round(Area_4_Monitoring_plan_follow()))), cex = 1.6, col = "black")
   })
 
 
 A2_Monitoring_plan_follow_Monitoring <- renderText({    
      
    Monitoring_Monitoring_plan_follow <- input$inCheckboxGroup_Monitoring_Techniques_Monitoring_plan_follow
      
      
    })

```


```{r PDF_Monitoring, echo=FALSE}


mainPanel( downloadButton(outputId = "download_Monitoring", label = "Download Monitoring Report"))


    output$download_Monitoring <- downloadHandler(
   filename = function() { paste("Monitoring", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(3,1))

         # 1st
        

 title_Monitor_number_defici_site= renderText({ input$Monitor_number_defici_site })

       Area_1_Monitor_number_defici_site <- reactive({ 0.5*as.numeric(A2_Monitor_number_defici_site())*input$Prob_Monitor_number_defici_site*sin(120)  }) 
 Area_2_Monitor_number_defici_site <- reactive({ 0.5*as.numeric(A2_Monitor_number_defici_site())*input$Det_Monitor_number_defici_site*sin(120)  }) 

Area_3_Monitor_number_defici_site <- reactive({ 0.5*input$Prob_Monitor_number_defici_site*input$Det_Monitor_number_defici_site*sin(120)  }) 
Area_4_Monitor_number_defici_site <-  reactive({ round(( Area_1_Monitor_number_defici_site()+Area_2_Monitor_number_defici_site()+Area_3_Monitor_number_defici_site()  ) /15.09589*100,
        digits = 0 )
           }) 
     
       Var1 <-as.numeric(A2_Monitor_number_defici_site())
         Var2 <-input$Prob_DEcision_DMSB_site
         Var3 <- input$Det_DEcision_DMSB_site
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Monitor_number_defici_site())                           
                              text(x = 0.5, y = 0.8, paste(round(Area_4_Monitor_number_defici_site())), cex = 1.6, col = "black")


      # 2nd
         
 title_escalation_process_monitor= renderText({ input$escalation_process_monitor })

       Area_1_escalation_process_monitor <- reactive({ 0.5*as.numeric(A2_escalation_process_monitor())*input$Prob_escalation_process_monitor*sin(120)  }) 
 Area_2_escalation_process_monitor<- reactive({ 0.5*as.numeric(A2_escalation_process_monitor())*input$Det_escalation_process_monitor*sin(120)  }) 

Area_3_escalation_process_monitor <- reactive({ 0.5*input$Prob_escalation_process_monitor*input$Det_escalation_process_monitor*sin(120)  }) 
Area_4_escalation_process_monitor <-  reactive({ Area_1_escalation_process_monitor()+Area_2_escalation_process_monitor()+Area_3_escalation_process_monitor()  }) 
     
       Var1 <-as.numeric(A2_escalation_process_monitor())
         Var2 <-input$Prob_escalation_process_monitor
         Var3 <- input$Det_escalation_process_monitor
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_escalation_process_monitor())                           
                              text(x = 0.5, y = 0.8, paste(round(Area_4_escalation_process_monitor())), cex = 1.6, col = "black")

         
         # 3rd
         

title_Monitoring_plan_follow= renderText({ input$Monitoring_plan_follow })

       Area_1_Monitoring_plan_follow <- reactive({ 0.5*as.numeric(A2_Monitoring_plan_follow())*input$Prob_Monitoring_plan_follow*sin(120)  }) 
 Area_2_Monitoring_plan_follow <- reactive({ 0.5*as.numeric(A2_Monitoring_plan_follow())*input$Det_Monitoring_plan_follow*sin(120)  }) 

Area_3_Monitoring_plan_follow <- reactive({ 0.5*input$Prob_Monitoring_plan_follow*input$Det_Monitoring_plan_follow*sin(120)  }) 
Area_4_Monitoring_plan_follow <-  reactive({ Area_1_Monitoring_plan_follow()+Area_2_Monitoring_plan_follow()+Area_3_Monitoring_plan_follow()  }) 
     
       Var1 <-as.numeric(A2_Monitoring_plan_follow())
         Var2 <-input$Prob_Monitoring_plan_follow
         Var3 <- input$Det_Monitoring_plan_follow
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Monitoring_plan_follow())                           
                              text(x = 0.5, y = 0.8, paste(round(Area_4_Monitoring_plan_follow())), cex = 1.6, col = "black")

                        dev.off()
   }
  )

```





## **`r colorize("Clinical Study Report", "mediumblue")`**
### **1. Having inconsistencies between source data and data reported in the CSR**
```{r echo=FALSE}
 
inputPanel(

    textInput("Inconsistencies_CSR_SD_DR", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Inconsistencies_CSR_SD_DR", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Inconsistencies_CSR_SD_DR", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Inconsistencies_CSR_SD_DR", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Inconsistencies_CSR_SD_DR", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Inconsistencies_CSR_SD_DR <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Inconsistencies_CSR_SD_DR))
      
      
    })



 title_Inconsistencies_CSR_SD_DR= renderText({ input$Inconsistencies_CSR_SD_DR })

 
 
    Area_1_Inconsistencies_CSR_SD_DR <- reactive({ 0.5*as.numeric(A2_Inconsistencies_CSR_SD_DR())*input$Prob_Inconsistencies_CSR_SD_DR*sin(120)  }) 
 Area_2_Inconsistencies_CSR_SD_DR <- reactive({ 0.5*as.numeric(A2_Inconsistencies_CSR_SD_DR())*input$Det_Inconsistencies_CSR_SD_DR*sin(120)  }) 

Area_3_Inconsistencies_CSR_SD_DR <- reactive({ 0.5*input$Prob_Inconsistencies_CSR_SD_DR*input$Det_Inconsistencies_CSR_SD_DR*sin(120)  }) 
Area_4_Inconsistencies_CSR_SD_DR <-  reactive({ round(( Area_1_Inconsistencies_CSR_SD_DR()+Area_2_Inconsistencies_CSR_SD_DR()+Area_3_Inconsistencies_CSR_SD_DR()  ) /15.09589*100,
        digits = 0 )
           })

 renderPlot({
   
       Var1 <-as.numeric(A2_Inconsistencies_CSR_SD_DR())
         Var2 <-input$Prob_Inconsistencies_CSR_SD_DR
         Var3 <- input$Det_Inconsistencies_CSR_SD_DR
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inconsistencies_CSR_SD_DR())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Inconsistencies_CSR_SD_DR()))=="NA", "Total Area",
                                  paste(round(Area_4_Inconsistencies_CSR_SD_DR()))), cex = 1.6, col = "black")
   })
 
  A2_Inconsistencies_CSR_SD_DR_Monitoring <- renderText({    
      
    Monitoring_Inconsistencies_CSR_SD_DR <- input$inCheckboxGroup_Monitoring_Techniques_Inconsistencies_CSR_SD_DR
      
      
    })

```


### **2. Inaccurate information being reported in CSR**
```{r echo=FALSE}
 
inputPanel(

    textInput("Inaccurate_CSR", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Inaccurate_CSR", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Inaccurate_CSR", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Inaccurate_CSR", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Inaccurate_CSR", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Inaccurate_CSR <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Inaccurate_CSR))
      
      
    })



 title_Inaccurate_CSR= renderText({ input$Inaccurate_CSR })

   Area_1_Inaccurate_CSR <- reactive({ 0.5*as.numeric(A2_Inaccurate_CSR())*input$Prob_Inaccurate_CSR*sin(120)  }) 
 Area_2_Inaccurate_CSR <- reactive({ 0.5*as.numeric(A2_Inaccurate_CSR())*input$Det_Inaccurate_CSR*sin(120)  }) 

Area_3_Inaccurate_CSR <- reactive({ 0.5*input$Prob_Inaccurate_CSR*input$Det_Inaccurate_CSR*sin(120)  }) 
Area_4_Inaccurate_CSR <-  reactive({ round(( Area_1_Inaccurate_CSR()+Area_2_Inaccurate_CSR()+Area_3_Inaccurate_CSR()  ) /15.09589*100,
        digits = 0 )
           }) 

 renderPlot({
   
        Var1 <-as.numeric(A2_Inaccurate_CSR())
         Var2 <-input$Prob_Inaccurate_CSR
         Var3 <- input$Det_Inaccurate_CSR
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inaccurate_CSR())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Inaccurate_CSR()))=="NA", "Total Area",
                                  paste(round(Area_4_Inaccurate_CSR()))), cex = 1.6, col = "black")
   })
 
 
  A2_Inaccurate_CSR_Monitoring <- renderText({    
      
    Monitoring_Inaccurate_CSR <- input$inCheckboxGroup_Monitoring_Techniques_Inaccurate_CSR
      
      
    })

```

### **3. Having relevant information missing in the CSR**
```{r echo=FALSE}
 
inputPanel(

    textInput("Relevant_INfo_CSR", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Relevant_INfo_CSR", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Relevant_INfo_CSR", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Relevant_INfo_CSR", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Relevant_INfo_CSR", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )


  A2_Relevant_INfo_CSR <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Relevant_INfo_CSR))
      
          })


 title_Relevant_INfo_CSR= renderText({ input$Relevant_INfo_CSR })

   Area_1_Relevant_INfo_CSR <- reactive({ 0.5*as.numeric(A2_Relevant_INfo_CSR())*input$Prob_Relevant_INfo_CSR*sin(120)  }) 
 Area_2_Relevant_INfo_CSR <- reactive({ 0.5*as.numeric(A2_Relevant_INfo_CSR())*input$Det_Relevant_INfo_CSR*sin(120)  }) 

Area_3_Relevant_INfo_CSR <- reactive({ 0.5*input$Prob_Relevant_INfo_CSR*input$Det_Relevant_INfo_CSR*sin(120)  }) 
Area_4_Relevant_INfo_CSR <-  reactive({ round((Area_1_Relevant_INfo_CSR()+Area_2_Relevant_INfo_CSR()+Area_3_Relevant_INfo_CSR()   ) /15.09589*100,
        digits = 0 )
          }) 
 
  renderPlot({
   
       Var1 <-as.numeric(A2_Relevant_INfo_CSR())
         Var2 <-input$Prob_Relevant_INfo_CSR
         Var3 <- input$Det_Relevant_INfo_CSR
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Relevant_INfo_CSR())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Relevant_INfo_CSR()))=="NA", "Total Area",
                                  paste(round(Area_4_Relevant_INfo_CSR()))), cex = 1.6, col = "black")
   })
 
  A2_Relevant_INfo_CSR_Monitoring <- renderText({    
      
    Monitoring_Relevant_INfo_CSR <- input$inCheckboxGroup_Monitoring_Techniques_Relevant_INfo_CSR
      
      
    })

```


```{r PDF_Clinical_study_report, echo=FALSE}

mainPanel( downloadButton(outputId = "download_clinical_study_report", label = "Download Clinical Study Report"))


    output$download_clinical_study_report <- downloadHandler(
   filename = function() { paste("Monitoring", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(3,1))

         # 1st
         
          title_Inconsistencies_CSR_SD_DR= renderText({ input$Inconsistencies_CSR_SD_DR })

   Area_1_Inconsistencies_CSR_SD_DR <- reactive({ 0.5*as.numeric(A2_Inconsistencies_CSR_SD_DR())*input$Prob_Inconsistencies_CSR_SD_DR*sin(120)  }) 
 Area_2_Inconsistencies_CSR_SD_DR <- reactive({ 0.5*as.numeric(A2_Inconsistencies_CSR_SD_DR())*input$Det_Inconsistencies_CSR_SD_DR*sin(120)  }) 

Area_3_Inconsistencies_CSR_SD_DR <- reactive({ 0.5*input$Prob_Inconsistencies_CSR_SD_DR*input$Det_Inconsistencies_CSR_SD_DR*sin(120)  }) 
Area_4_Inconsistencies_CSR_SD_DR <-  reactive({ Area_1_Inconsistencies_CSR_SD_DR()+Area_2_Inconsistencies_CSR_SD_DR()+Area_3_Inconsistencies_CSR_SD_DR()  }) 
     
       Var1 <-as.numeric(A2_Inconsistencies_CSR_SD_DR())
         Var2 <-input$Prob_Inconsistencies_CSR_SD_DR
         Var3 <- input$Det_Inconsistencies_CSR_SD_DR
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inconsistencies_CSR_SD_DR())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_Inconsistencies_CSR_SD_DR())), cex = 1.6, col = "black")

         
         # 2nd 
         
 title_Inaccurate_CSR= renderText({ input$Inaccurate_CSR })

   Area_1_Inaccurate_CSR <- reactive({ 0.5*as.numeric(A2_Inaccurate_CSR())*input$Prob_Inaccurate_CSR*sin(120)  }) 
 Area_2_Inaccurate_CSR <- reactive({ 0.5*as.numeric(A2_Inaccurate_CSR())*input$Det_Inaccurate_CSR*sin(120)  }) 

Area_3_Inaccurate_CSR <- reactive({ 0.5*input$Prob_Inaccurate_CSR*input$Det_Inaccurate_CSR*sin(120)  }) 
Area_4_Inaccurate_CSR <-  reactive({ Area_1_Inaccurate_CSR()+Area_2_Inaccurate_CSR()+Area_3_Inaccurate_CSR()  }) 
     
       Var1 <-as.numeric(A2_Inaccurate_CSR())
         Var2 <-input$Prob_Inaccurate_CSR
         Var3 <- input$Det_Inaccurate_CSR
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inaccurate_CSR())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_Inaccurate_CSR())), cex = 1.6, col = "black")

         
         
         
         # 3rd
         
      
 title_Relevant_INfo_CSR= renderText({ input$Relevant_INfo_CSR })

 Area_1_Relevant_INfo_CSR <- reactive({ 0.5*as.numeric(A2_Relevant_INfo_CSR())*input$Prob_Relevant_INfo_CSR*sin(120)  }) 
 Area_2_Relevant_INfo_CSR <- reactive({ 0.5*as.numeric(A2_Relevant_INfo_CSR())*input$Det_Relevant_INfo_CSR*sin(120)  }) 

Area_3_Relevant_INfo_CSR <- reactive({ 0.5*input$Prob_Relevant_INfo_CSR*input$Det_Relevant_INfo_CSR*sin(120)  }) 
Area_4_Relevant_INfo_CSR <-  reactive({ Area_1_Relevant_INfo_CSR()+Area_2_Relevant_INfo_CSR()+Area_3_Relevant_INfo_CSR()  }) 
     
       Var1 <-as.numeric(A2_Relevant_INfo_CSR())
         Var2 <-input$Prob_Relevant_INfo_CSR
         Var3 <- input$Det_Relevant_INfo_CSR
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Relevant_INfo_CSR())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_Relevant_INfo_CSR())), cex = 1.6, col = "black")

                      dev.off()
   }
  )


```




## **`r colorize("Document Control", "mediumblue")`**

### **1. Lack of version/date on the document**
```{r echo=FALSE}
 
inputPanel(

    textInput("document_version_date", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_document_version_date", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_document_version_date", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_document_version_date", "Detectabilty", NA, min = 1, max = 2), 
     checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_document_version_date", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_document_version_date <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_document_version_date))
      
      
    })



 title_document_version_date= renderText({ input$document_version_date })

 Area_1_document_version_date <- reactive({ 0.5*as.numeric(A2_document_version_date())*input$Prob_document_version_date*sin(120)  }) 
 Area_2_document_version_date <- reactive({ 0.5*as.numeric(A2_document_version_date())*input$Det_document_version_date*sin(120)  }) 

Area_3_document_version_date <- reactive({ 0.5*input$Prob_document_version_date*input$Det_document_version_date*sin(120)  }) 
Area_4_document_version_date <-  reactive({ round(( Area_1_document_version_date()+Area_2_document_version_date()+Area_3_document_version_date()   ) /15.09589*100,
        digits = 0 )
          }) 

  renderPlot({
   
     
         Var1 <-as.numeric(A2_document_version_date())
         Var2 <-input$Prob_document_version_date
         Var3 <- input$Det_document_version_date
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_document_version_date())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_document_version_date()))=="NA", "Total Area",
                                  paste(round(Area_4_document_version_date()))), cex = 1.6, col = "black")
   })
 
  A2_document_version_date_Monitoring <- renderText({    
      
    Monitoring_document_version_date <- input$inCheckboxGroup_Monitoring_Techniques_document_version_date
      
      
    })

```

### **2. Late introduction of amendments in the study**
```{r echo=FALSE}
 
inputPanel(

    textInput("amendment_late_study", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_amendment_late_study", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_amendment_late_study", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_amendment_late_study", "Detectabilty", NA, min = 1, max = 2), 
     checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_amendment_late_study", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )

  A2_amendment_late_study <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_amendment_late_study))
      
    })

 title_amendment_late_study= renderText({ input$amendment_late_study })

 
   Area_1_amendment_late_study <- reactive({ 0.5*as.numeric(A2_amendment_late_study())*input$Prob_amendment_late_study*sin(120)  }) 
 Area_2_amendment_late_study <- reactive({ 0.5*as.numeric(A2_amendment_late_study())*input$Det_amendment_late_study*sin(120)  }) 

Area_3_amendment_late_study <- reactive({ 0.5*input$Prob_amendment_late_study*input$Det_amendment_late_study*sin(120)  }) 
Area_4_amendment_late_study <-  reactive({round(( Area_1_amendment_late_study()+Area_2_amendment_late_study()+Area_3_amendment_late_study()  ) /15.09589*100,
        digits = 0 )
           }) 
 
 renderPlot({
   
     
        Var1 <-as.numeric(A2_amendment_late_study())
         Var2 <-input$Prob_amendment_late_study
         Var3 <- input$Det_amendment_late_study
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_amendment_late_study())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_amendment_late_study()))=="NA", "Total Area",
                                  paste(round(Area_4_amendment_late_study()))), cex = 1.6, col = "black")
   })
 
  A2_amendment_late_study_Monitoring <- renderText({    
      
    Monitoring_amendment_late_study <- input$inCheckboxGroup_Monitoring_Techniques_amendment_late_study
      
      
    })

```

```{r PDF_Document_control, echo=FALSE}
 mainPanel( downloadButton(outputId = "download_Document_control", label = "Download Document Control Report"))


    output$download_Document_control <- downloadHandler(
   filename = function() { paste("Essential Document", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(2,1))

         
    # 1st 
         
 title_document_version_date= renderText({ input$document_version_date })

 Area_1_document_version_date <- reactive({ 0.5*as.numeric(A2_document_version_date())*input$Prob_document_version_date*sin(120)  }) 
 Area_2_document_version_date <- reactive({ 0.5*as.numeric(A2_document_version_date())*input$Det_document_version_date*sin(120)  }) 

Area_3_document_version_date <- reactive({ 0.5*input$Prob_document_version_date*input$Det_document_version_date*sin(120)  }) 
Area_4_document_version_date <-  reactive({ Area_1_document_version_date()+Area_2_document_version_date()+Area_3_document_version_date()  }) 

     
       Var1 <-as.numeric(A2_document_version_date())
         Var2 <-input$Prob_document_version_date
         Var3 <- input$Det_document_version_date
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_document_version_date())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_document_version_date())), cex = 1.6, col = "black")

         
         
         
         
  # 2nd
         
         
          title_amendment_late_study= renderText({ input$amendment_late_study })

   Area_1_amendment_late_study <- reactive({ 0.5*as.numeric(A2_amendment_late_study())*input$Prob_amendment_late_study*sin(120)  }) 
 Area_2_amendment_late_study <- reactive({ 0.5*as.numeric(A2_amendment_late_study())*input$Det_amendment_late_study*sin(120)  }) 

Area_3_amendment_late_study <- reactive({ 0.5*input$Prob_amendment_late_study*input$Det_amendment_late_study*sin(120)  }) 
Area_4_amendment_late_study <-  reactive({ Area_1_amendment_late_study()+Area_2_amendment_late_study()+Area_3_amendment_late_study()  }) 

     
       Var1 <-as.numeric(A2_amendment_late_study())
         Var2 <-input$Prob_amendment_late_study
         Var3 <- input$Det_amendment_late_study
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_amendment_late_study())                           
                                 text(x = 0.5, y = 0.8, paste(round(Area_4_amendment_late_study())), cex = 1.6, col = "black")

         
         

        dev.off()
   }
  )

```

## **`r colorize("Protocol compliance - selection criteria", "mediumblue")`**

### **1. Violation of inclusion criteria**
```{r echo=FALSE}
 
inputPanel(

      textInput("inclusion_violation_criteria", "such as ", ""),
    
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_inclusion_violation_criteria", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_inclusion_violation_criteria", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_inclusion_violation_criteria", "Detectabilty", NA, min = 1, max = 2), 
    checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_inclusion_violation_criteria", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_inclusion_violation_criteria <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_inclusion_violation_criteria))
      
      
    })



 title_inclusion_violation_criteria= renderText({ input$inclusion_violation_criteria })


    
   Area_1_inclusion_violation_criteria <- reactive({ 0.5*as.numeric(A2_inclusion_violation_criteria())*input$Prob_inclusion_violation_criteria*sin(120)  })
   
 Area_2_inclusion_violation_criteria <- reactive({ 0.5*as.numeric(A2_inclusion_violation_criteria())*input$Det_inclusion_violation_criteria*sin(120)  }) 

Area_3_inclusion_violation_criteria <- reactive({ 0.5*input$Prob_inclusion_violation_criteria*input$Det_inclusion_violation_criteria*sin(120)  }) 
Area_4_inclusion_violation_criteria <-  reactive({ round(( Area_1_inclusion_violation_criteria()+Area_2_inclusion_violation_criteria()+Area_3_inclusion_violation_criteria() ) /15.09589*100,
        digits = 0 )
            }) 
 
  renderPlot({
   

     
       Var1 <-as.numeric(A2_inclusion_violation_criteria())
         Var2 <-input$Prob_inclusion_violation_criteria
         Var3 <- input$Det_inclusion_violation_criteria
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_inclusion_violation_criteria())                           
            text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_inclusion_violation_criteria()))=="NA", "Total Area",
                                  paste(round(Area_4_inclusion_violation_criteria()))), cex = 1.6, col = "black")


   })

 
  A2_inclusion_violation_criteria_Monitoring <- renderText({    
      
    Monitoring_inclusion_violation_criteria <- input$inCheckboxGroup_Monitoring_Techniques_inclusion_violation_criteria
      
      
    })
```

### **2. Having missing documentation of the final decision about eligibility **
```{r echo=FALSE}
 
inputPanel(

    textInput("Final_decision_records", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Final_decision_records", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Final_decision_records", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Final_decision_records", "Detectabilty", NA, min = 1, max = 2), 
    checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Final_decision_records", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Final_decision_records <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Final_decision_records))
      
      
    })



 title_Final_decision_records= renderText({ input$Final_decision_records })


    Area_1_Final_decision_records <- reactive({ 0.5*as.numeric(A2_Final_decision_records())*input$Prob_Final_decision_records*sin(120)  }) 
 Area_2_Final_decision_records <- reactive({ 0.5*as.numeric(A2_Final_decision_records())*input$Det_Final_decision_records*sin(120)  }) 

Area_3_Final_decision_records <- reactive({ 0.5*input$Prob_Final_decision_records*input$Det_Final_decision_records*sin(120)  }) 
Area_4_Final_decision_records <-  reactive({ 
  round(( Area_1_Final_decision_records()+Area_2_Final_decision_records()+Area_3_Final_decision_records() ) /15.09589*100,
        digits = 0 )
})
  renderPlot({
   
   
     Var1 <-as.numeric(A2_Final_decision_records())
         Var2 <-input$Prob_Final_decision_records
         Var3 <- input$Det_Final_decision_records
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Final_decision_records())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Final_decision_records()))=="NA", "Total Area",
                                  paste(round(Area_4_Final_decision_records()))), cex = 1.6, col = "black")

   })
 
 
  A2_Final_decision_records_Monitoring <- renderText({    
      
    Monitoring_Final_decision_records <- input$inCheckboxGroup_Monitoring_Techniques_Final_decision_records
      
      
    })

```

```{r PDF_Protocol_compliance_selection_criteria, echo=FALSE}

 mainPanel( downloadButton(outputId = "download_Protocol_compliance_selection_criteria", label = "Download Protocol Compliance - Selection Criteria Report"))


    output$download_Protocol_compliance_selection_criteria <- downloadHandler(
   filename = function() { paste("Protocols Compliance Selection Criteria", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(2,1))

     #1st    
         
       title_inclusion_violation_criteria= renderText({ input$inclusion_violation_criteria })

   Area_1_inclusion_violation_criteria <- reactive({ 0.5*as.numeric(A2_inclusion_violation_criteria())*input$Prob_inclusion_violation_criteria*sin(120)  })
   
 Area_2_inclusion_violation_criteria <- reactive({ 0.5*as.numeric(A2_inclusion_violation_criteria())*input$Det_inclusion_violation_criteria*sin(120)  }) 

Area_3_inclusion_violation_criteria <- reactive({ 0.5*input$Prob_inclusion_violation_criteria*input$Det_inclusion_violation_criteria*sin(120)  }) 
Area_4_inclusion_violation_criteria <-  reactive({ Area_1_inclusion_violation_criteria()+Area_2_inclusion_violation_criteria()+Area_3_inclusion_violation_criteria()  }) 
     
       Var1 <-as.numeric(A2_inclusion_violation_criteria())
         Var2 <-input$Prob_inclusion_violation_criteria
         Var3 <- input$Det_inclusion_violation_criteria
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_inclusion_violation_criteria())                           
                                    text(x = 0.5, y = 0.8, paste(round(Area_4_inclusion_violation_criteria())), cex = 1.6, col = "black")
  
 
# 2nd
 

 title_Final_decision_records= renderText({ input$Final_decision_records })

   Area_1_Final_decision_records <- reactive({ 0.5*as.numeric(A2_Final_decision_records())*input$Prob_Final_decision_records*sin(120)  }) 
 Area_2_Final_decision_records <- reactive({ 0.5*as.numeric(A2_Final_decision_records())*input$Det_Final_decision_records*sin(120)  }) 

Area_3_Final_decision_records <- reactive({ 0.5*input$Prob_Final_decision_records*input$Det_Final_decision_records*sin(120)  }) 
Area_4_Final_decision_records <-  reactive({ Area_1_Final_decision_records()+Area_2_Final_decision_records()+Area_3_Final_decision_records()  }) 
     
       Var1 <-as.numeric(A2_Final_decision_records())
         Var2 <-input$Prob_Final_decision_records
         Var3 <- input$Det_Final_decision_records
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Final_decision_records())                           
                                    text(x = 0.5, y = 0.8, paste(round(Area_4_Final_decision_records())), cex = 1.6, col = "black")



       dev.off()
   }
  )



```



## **`r colorize("Reporting in CRF/diary", "mediumblue")`**

### **1. Having disrepancies between source data such as medical history, concomitant medication etc. and the CRF for a sample of subjects**

```{r echo=FALSE}
 
inputPanel(

    textInput("Discrepancies_medical_history", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Discrepancies_medical_history", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Discrepancies_medical_history", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Discrepancies_medical_history", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Discrepancies_medical_history", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Discrepancies_medical_history <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Discrepancies_medical_history))
      
      
    })



 title_Discrepancies_medical_history= renderText({ input$Discrepancies_medical_history })

   Area_1_Discrepancies_medical_history <- reactive({ 0.5*as.numeric(A2_Discrepancies_medical_history())*input$Prob_Discrepancies_medical_history*sin(120)  }) 
 Area_2_Discrepancies_medical_history <- reactive({ 0.5*as.numeric(A2_Discrepancies_medical_history())*input$Det_Discrepancies_medical_history*sin(120)  }) 

Area_3_Discrepancies_medical_history <- reactive({ 0.5*input$Prob_Discrepancies_medical_history*input$Det_Discrepancies_medical_history*sin(120)  }) 
Area_4_Discrepancies_medical_history <-  reactive({ round(( Area_1_Discrepancies_medical_history()+Area_2_Discrepancies_medical_history()+Area_3_Discrepancies_medical_history() ) /15.09589*100,
        digits = 0 ) }) 
 
  renderPlot({
   

       Var1 <-as.numeric(A2_Discrepancies_medical_history())
         Var2 <-input$Prob_Discrepancies_medical_history
         Var3 <- input$Det_Discrepancies_medical_history
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Discrepancies_medical_history())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Discrepancies_medical_history()))=="NA", "Total Area",
                                  paste(round(Area_4_Discrepancies_medical_history()))), cex = 1.6, col = "black")
   })
 A2_Discrepancies_medical_history_Monitoring <- renderText({    
      
    Monitoring_Discrepancies_medical_history <- input$inCheckboxGroup_Monitoring_Techniques_Discrepancies_medical_history
      
    })
  

```


### **2. Having corrections on CRF that won't not be signed and dated**
```{r echo=FALSE}
 
inputPanel(

    textInput("Corrections_CRF_sign", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Corrections_CRF_sign", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Corrections_CRF_sign", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Corrections_CRF_sign", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Corrections_CRF_sign", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Corrections_CRF_sign <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Corrections_CRF_sign))
      
      
    })



 title_Corrections_CRF_sign= renderText({ input$Corrections_CRF_sign })

  Area_1_Corrections_CRF_sign <- reactive({ 0.5*as.numeric(A2_Corrections_CRF_sign())*input$Prob_Corrections_CRF_sign*sin(120)  }) 
 Area_2_Corrections_CRF_sign <- reactive({ 0.5*as.numeric(A2_Corrections_CRF_sign())*input$Det_Corrections_CRF_sign*sin(120)  }) 

Area_3_Corrections_CRF_sign <- reactive({ 0.5*input$Prob_Corrections_CRF_sign*input$Det_Corrections_CRF_sign*sin(120)  }) 
Area_4_Corrections_CRF_sign <-  reactive({ round(( Area_1_Corrections_CRF_sign()+Area_2_Corrections_CRF_sign()+Area_3_Corrections_CRF_sign() ) /15.09589*100,
        digits = 0 )  }) 
 
  renderPlot({
   
       Var1 <-as.numeric(A2_Corrections_CRF_sign())
         Var2 <-input$Prob_Corrections_CRF_sign
         Var3 <- input$Det_Corrections_CRF_sign
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Corrections_CRF_sign())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Corrections_CRF_sign()))=="NA", "Total Area",
                                  paste(round(Area_4_Corrections_CRF_sign()))), cex = 1.6, col = "black") 
   })
 
 A2_Corrections_CRF_sign_Monitoring <- renderText({    
      
    Monitoring_Corrections_CRF_sign <- input$inCheckboxGroup_Monitoring_Techniques_Corrections_CRF_sign
      
    })
  

```


### **3. Not reporting data in CRF in a timely manner**
```{r echo=FALSE}
 
inputPanel(

    textInput("Data_CRF_Reported", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Data_CRF_Reported", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Data_CRF_Reported", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Data_CRF_Reported", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Data_CRF_Reported", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Data_CRF_Reported <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Data_CRF_Reported))
      
      
    })


 title_Data_CRF_Reported= renderText({ input$Data_CRF_Reported })

  Area_1_Data_CRF_Reported <- reactive({ 0.5*as.numeric(A2_Data_CRF_Reported())*input$Prob_Data_CRF_Reported*sin(120)  }) 
 Area_2_Data_CRF_Reported <- reactive({ 0.5*as.numeric(A2_Data_CRF_Reported())*input$Det_Data_CRF_Reported*sin(120)  }) 

Area_3_Data_CRF_Reported <- reactive({ 0.5*input$Prob_Data_CRF_Reported*input$Det_Data_CRF_Reported*sin(120)  }) 
Area_4_Data_CRF_Reported <-  reactive({ round(( Area_1_Data_CRF_Reported()+Area_2_Data_CRF_Reported()+Area_3_Data_CRF_Reported()  ) /15.09589*100,
        digits = 0 )
  }) 

 
 renderPlot({
   
        Var1 <-as.numeric(A2_Data_CRF_Reported())
         Var2 <-input$Prob_Data_CRF_Reported
         Var3 <- input$Det_Data_CRF_Reported
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Data_CRF_Reported())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Data_CRF_Reported()))=="NA", "Total Area",
                                  paste(round(Area_4_Data_CRF_Reported()))), cex = 1.6, col = "black") 
   })
 
 A2_Data_CRF_Reported_Monitoring <- renderText({    
      
    Monitoring_Data_CRF_Reported <- input$inCheckboxGroup_Monitoring_Techniques_Data_CRF_Reported
      
    })
  

```


```{r PDF_CRF_Diary, echo=FALSE}

 mainPanel( downloadButton(outputId = "download_CRF_Diary", label = "Download CRF/Diary Report"))


    output$download_CRF_Diary <- downloadHandler(
   filename = function() { paste("CRF/Diary Report", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(3,1))

       # 1st
         
         
          title_Discrepancies_medical_history= renderText({ input$Discrepancies_medical_history })
   
   Area_1_Discrepancies_medical_history <- reactive({ 0.5*as.numeric(A2_Discrepancies_medical_history())*input$Prob_Discrepancies_medical_history*sin(120)  }) 
 Area_2_Discrepancies_medical_history <- reactive({ 0.5*as.numeric(A2_Discrepancies_medical_history())*input$Det_Discrepancies_medical_history*sin(120)  }) 

Area_3_Discrepancies_medical_history <- reactive({ 0.5*input$Prob_Discrepancies_medical_history*input$Det_Discrepancies_medical_history*sin(120)  }) 
Area_4_Discrepancies_medical_history <-  reactive({ Area_1_Discrepancies_medical_history()+Area_2_Discrepancies_medical_history()+Area_3_Discrepancies_medical_history()  }) 

     
       Var1 <-as.numeric(A2_Discrepancies_medical_history())
         Var2 <-input$Prob_Discrepancies_medical_history
         Var3 <- input$Det_Discrepancies_medical_history
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Discrepancies_medical_history())                           
                                    text(x = 0.5, y = 0.8, paste(round(Area_4_Discrepancies_medical_history())), cex = 1.6, col = "black")

         
         # 2nd
         
 title_Corrections_CRF_sign= renderText({ input$Corrections_CRF_sign })

  Area_1_Corrections_CRF_sign <- reactive({ 0.5*as.numeric(A2_Corrections_CRF_sign())*input$Prob_Corrections_CRF_sign*sin(120)  }) 
 Area_2_Corrections_CRF_sign <- reactive({ 0.5*as.numeric(A2_Corrections_CRF_sign())*input$Det_Corrections_CRF_sign*sin(120)  }) 

Area_3_Corrections_CRF_sign <- reactive({ 0.5*input$Prob_Corrections_CRF_sign*input$Det_Corrections_CRF_sign*sin(120)  }) 
Area_4_Corrections_CRF_sign <-  reactive({ Area_1_Corrections_CRF_sign()+Area_2_Corrections_CRF_sign()+Area_3_Corrections_CRF_sign()  }) 

     
       Var1 <-as.numeric(A2_Corrections_CRF_sign())
         Var2 <-input$Prob_Corrections_CRF_sign
         Var3 <- input$Det_Corrections_CRF_sign
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Corrections_CRF_sign())                           
                                      text(x = 0.5, y = 0.8, paste(round(Area_4_Corrections_CRF_sign())), cex = 1.6, col = "black")
 
         
         
         # 3rd
         
         title_Data_CRF_Reported= renderText({ input$Data_CRF_Reported })
   
  Area_1_Data_CRF_Reported <- reactive({ 0.5*as.numeric(A2_Data_CRF_Reported())*input$Prob_Data_CRF_Reported*sin(120)  }) 
 Area_2_Data_CRF_Reported <- reactive({ 0.5*as.numeric(A2_Data_CRF_Reported())*input$Det_Data_CRF_Reported*sin(120)  }) 

Area_3_Data_CRF_Reported <- reactive({ 0.5*input$Prob_Data_CRF_Reported*input$Det_Data_CRF_Reported*sin(120)  }) 
Area_4_Data_CRF_Reported <-  reactive({ Area_1_Data_CRF_Reported()+Area_2_Data_CRF_Reported()+Area_3_Data_CRF_Reported()  }) 

     
       Var1 <-as.numeric(A2_Data_CRF_Reported())
         Var2 <-input$Prob_Data_CRF_Reported
         Var3 <- input$Det_Data_CRF_Reported
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Data_CRF_Reported())                           
                                      text(x = 0.5, y = 0.8, paste(round(Area_4_Data_CRF_Reported())), cex = 1.6, col = "black")
 
         
         
         
         
         
         
        dev.off()
   }
  )


```
 
## **`r colorize("Protocol compliance - others", "mediumblue")`**
### **1. IMP and concomitant medication protocol deviations**
```{r echo=FALSE}

inputPanel(

    textInput("IMP_Concomitant_medication", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_IMP_Concomitant_medication", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_IMP_Concomitant_medication", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_IMP_Concomitant_medication", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_IMP_Concomitant_medication", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_IMP_Concomitant_medication <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_IMP_Concomitant_medication))
      
      
    })



 title_IMP_Concomitant_medication= renderText({ input$IMP_Concomitant_medication })

 
    Area_1_IMP_Concomitant_medication <- reactive({ 0.5*as.numeric(A2_IMP_Concomitant_medication())*input$Prob_IMP_Concomitant_medication*sin(120)  }) 
 Area_2_IMP_Concomitant_medication <- reactive({ 0.5*as.numeric(A2_IMP_Concomitant_medication())*input$Det_IMP_Concomitant_medication*sin(120)  }) 

Area_3_IMP_Concomitant_medication <- reactive({ 0.5*input$Prob_IMP_Concomitant_medication*input$Det_IMP_Concomitant_medication*sin(120)  }) 
Area_4_IMP_Concomitant_medication <-  reactive({  round(( Area_1_IMP_Concomitant_medication()+Area_2_IMP_Concomitant_medication()+Area_3_IMP_Concomitant_medication()) /15.09589*100,
        digits = 0 )  }) 
 
 renderPlot({
   
 
       Var1 <-as.numeric(A2_IMP_Concomitant_medication())
         Var2 <-input$Prob_IMP_Concomitant_medication
         Var3 <- input$Det_IMP_Concomitant_medication
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_IMP_Concomitant_medication())                           
            text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_IMP_Concomitant_medication()))=="NA", "Total Area",
                                  paste(round(Area_4_IMP_Concomitant_medication()))), cex = 1.6, col = "black")

   })
 
  A2_IMP_Concomitant_medication_Monitoring <- renderText({    
      
    Monitoring_IMP_Concomitant_medication <- input$inCheckboxGroup_Monitoring_Techniques_IMP_Concomitant_medication
      
    })
  

```

### **2. Protocol visits not being performed within the visit windows specified in the protocol**
```{r echo=FALSE}
 
inputPanel(

    textInput("Protocol_visit_window", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Protocol_visit_window", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Protocol_visit_window", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Protocol_visit_window", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Protocol_visit_window", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

  

         )



  A2_Protocol_visit_window <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Protocol_visit_window))
      
      
    })



 title_Protocol_visit_window= renderText({ input$Protocol_visit_window })

    Area_1_Protocol_visit_window <- reactive({ 0.5*as.numeric(A2_Protocol_visit_window())*input$Prob_Protocol_visit_window*sin(120)  }) 
 Area_2_Protocol_visit_window <- reactive({ 0.5*as.numeric(A2_Protocol_visit_window())*input$Det_Protocol_visit_window*sin(120)  }) 

Area_3_Protocol_visit_window <- reactive({ 0.5*input$Prob_Protocol_visit_window*input$Det_Protocol_visit_window*sin(120)  }) 
Area_4_Protocol_visit_window <-  reactive({ round(( Area_1_Protocol_visit_window()+Area_2_Protocol_visit_window()+Area_3_Protocol_visit_window() ) /15.09589*100,
        digits = 0 ) }) 
 
  renderPlot({
   

       Var1 <-as.numeric(A2_Protocol_visit_window())
         Var2 <-input$Prob_Protocol_visit_window
         Var3 <- input$Det_Protocol_visit_window
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Protocol_visit_window())                           
       text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Protocol_visit_window()))=="NA", "Total Area",
                                  paste(round(Area_4_Protocol_visit_window()))), cex = 1.6, col = "black")

   })
 
  A2_Protocol_visit_window_Monitoring <- renderText({    
      
    Monitoring_Protocol_visit_window <- input$inCheckboxGroup_Monitoring_Techniques_Protocol_visit_window
      
    })
  

```

### **3. Having a system that prospectively accepts deviations from the protocol**
```{r echo=FALSE}
 
inputPanel(

    textInput("Sponsor_system_deviation", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Sponsor_system_deviation", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Sponsor_system_deviation", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Sponsor_system_deviation", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Sponsor_system_deviation", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))


         )



  A2_Sponsor_system_deviation <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Sponsor_system_deviation))
      
      
    })



 title_Sponsor_system_deviation= renderText({ input$Sponsor_system_deviation })

    Area_1_Sponsor_system_deviation <- reactive({ 0.5*as.numeric(A2_Sponsor_system_deviation())*input$Prob_Sponsor_system_deviation*sin(120)  }) 
 Area_2_Sponsor_system_deviation <- reactive({ 0.5*as.numeric(A2_Sponsor_system_deviation())*input$Det_Sponsor_system_deviation*sin(120)  }) 

Area_3_Sponsor_system_deviation <- reactive({ 0.5*input$Prob_Sponsor_system_deviation*input$Det_Sponsor_system_deviation*sin(120)  }) 
Area_4_Sponsor_system_deviation <-  reactive({ round(( Area_1_Sponsor_system_deviation()+Area_2_Sponsor_system_deviation()+Area_3_Sponsor_system_deviation()) /15.09589*100,
        digits = 0 )  }) 
 
  renderPlot({

     
       Var1 <-as.numeric(A2_Sponsor_system_deviation())
         Var2 <-input$Prob_Sponsor_system_deviation
         Var3 <- input$Det_Sponsor_system_deviation
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Sponsor_system_deviation())                           
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Sponsor_system_deviation()))=="NA", "Total Area",
                                  paste(round(Area_4_Sponsor_system_deviation()))), cex = 1.6, col = "black")

   })
 
 
  A2_Sponsor_system_deviation_Monitoring <- renderText({    
      
    Monitoring_Sponsor_system_deviation <- input$inCheckboxGroup_Monitoring_Techniques_Sponsor_system_deviation
      
    })
  

```



### **4. Having insufficient maintenance of blinding procedure of the IMP**
```{r echo=FALSE}
 
inputPanel(

    textInput("Risk_unblinding_IMP", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Risk_unblinding_IMP", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Risk_unblinding_IMP", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Risk_unblinding_IMP", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Risk_unblinding_IMP", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))


         )



  A2_Risk_unblinding_IMP <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Risk_unblinding_IMP))
      
      
    })



 title_Risk_unblinding_IMP= renderText({ input$Risk_unblinding_IMP })

 
 
    Area_1_Risk_unblinding_IMP <- reactive({ 0.5*as.numeric(A2_Risk_unblinding_IMP())*input$Prob_Risk_unblinding_IMP*sin(120)  }) 
 Area_2_Risk_unblinding_IMP <- reactive({ 0.5*as.numeric(A2_Risk_unblinding_IMP())*input$Det_Risk_unblinding_IMP*sin(120)  }) 

Area_3_Risk_unblinding_IMP <- reactive({ 0.5*input$Prob_Risk_unblinding_IMP*input$Det_Risk_unblinding_IMP*sin(120)  }) 
Area_4_Risk_unblinding_IMP <-  reactive({ round((Area_1_Risk_unblinding_IMP()+Area_2_Risk_unblinding_IMP()+Area_3_Risk_unblinding_IMP()) /15.09589*100,
        digits = 0 )  }) 


 renderPlot({
   
 
       Var1 <-as.numeric(A2_Risk_unblinding_IMP())
         Var2 <-input$Prob_Risk_unblinding_IMP
         Var3 <- input$Det_Risk_unblinding_IMP
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Risk_unblinding_IMP())                           
text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk_unblinding_IMP()))=="NA", "Total Area",
                                  paste(round(Area_4_Risk_unblinding_IMP()))), cex = 1.6, col = "black")  
   })
 
 
  A2_Risk_unblinding_IMP_Monitoring <- renderText({    
      
    Monitoring_Risk_unblinding_IMP <- input$inCheckboxGroup_Monitoring_Techniques_Risk_unblinding_IMP
      
    })
  

```

```{r PDF_Protocol_compliance_others, echo=FALSE}
 mainPanel( downloadButton(outputId = "PDF_Protocol_compliance_others", label = "Download Protocol compliance/others Report"))


    output$PDF_Protocol_compliance_others <- downloadHandler(
   filename = function() { paste("Protocol compliance/others Report", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(2,2))

       # 1st

         
 title_IMP_Concomitant_medication= renderText({ input$IMP_Concomitant_medication })
   
    Area_1_IMP_Concomitant_medication <- reactive({ 0.5*as.numeric(A2_IMP_Concomitant_medication())*input$Prob_IMP_Concomitant_medication*sin(120)  }) 
 Area_2_IMP_Concomitant_medication <- reactive({ 0.5*as.numeric(A2_IMP_Concomitant_medication())*input$Det_IMP_Concomitant_medication*sin(120)  }) 

Area_3_IMP_Concomitant_medication <- reactive({ 0.5*input$Prob_IMP_Concomitant_medication*input$Det_IMP_Concomitant_medication*sin(120)  }) 
Area_4_IMP_Concomitant_medication <-  reactive({ Area_1_IMP_Concomitant_medication()+Area_2_IMP_Concomitant_medication()+Area_3_IMP_Concomitant_medication()  }) 

     
     
       Var1 <-as.numeric(A2_IMP_Concomitant_medication())
         Var2 <-input$Prob_IMP_Concomitant_medication
         Var3 <- input$Det_IMP_Concomitant_medication
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_IMP_Concomitant_medication())                           
                                    text(x = 0.5, y = 0.8, paste(round(Area_4_IMP_Concomitant_medication())), cex = 1.6, col = "black")
         
         
         
         
        # 2nd 
      
         
          title_Protocol_visit_window= renderText({ input$Protocol_visit_window })

   
    Area_1_Protocol_visit_window <- reactive({ 0.5*as.numeric(A2_Protocol_visit_window())*input$Prob_Protocol_visit_window*sin(120)  }) 
 Area_2_Protocol_visit_window <- reactive({ 0.5*as.numeric(A2_Protocol_visit_window())*input$Det_Protocol_visit_window*sin(120)  }) 

Area_3_Protocol_visit_window <- reactive({ 0.5*input$Prob_Protocol_visit_window*input$Det_Protocol_visit_window*sin(120)  }) 
Area_4_Protocol_visit_window <-  reactive({ Area_1_Protocol_visit_window()+Area_2_Protocol_visit_window()+Area_3_Protocol_visit_window()  }) 

     
     
       Var1 <-as.numeric(A2_Protocol_visit_window())
         Var2 <-input$Prob_Protocol_visit_window
         Var3 <- input$Det_Protocol_visit_window
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Protocol_visit_window())                           
                                       text(x = 0.5, y = 0.8, paste(round(Area_4_Protocol_visit_window())), cex = 1.6, col = "black")
         
         
         
         
         
         
         
         
         # 3rd 
         
          title_Sponsor_system_deviation= renderText({ input$Sponsor_system_deviation })

    Area_1_Sponsor_system_deviation <- reactive({ 0.5*as.numeric(A2_Sponsor_system_deviation())*input$Prob_Sponsor_system_deviation*sin(120)  }) 
 Area_2_Sponsor_system_deviation <- reactive({ 0.5*as.numeric(A2_Sponsor_system_deviation())*input$Det_Sponsor_system_deviation*sin(120)  }) 

Area_3_Sponsor_system_deviation <- reactive({ 0.5*input$Prob_Sponsor_system_deviation*input$Det_Sponsor_system_deviation*sin(120)  }) 
Area_4_Sponsor_system_deviation <-  reactive({ Area_1_Sponsor_system_deviation()+Area_2_Sponsor_system_deviation()+Area_3_Sponsor_system_deviation()  }) 

     
   
     
       Var1 <-as.numeric(A2_Sponsor_system_deviation())
         Var2 <-input$Prob_Sponsor_system_deviation
         Var3 <- input$Det_Sponsor_system_deviation
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Sponsor_system_deviation())                           
                                    text(x = 0.5, y = 0.8, paste(round(Area_4_Sponsor_system_deviation())), cex = 1.6, col = "black")
         
       
         
         # 4th 
         
         
         title_Risk_unblinding_IMP= renderText({ input$Risk_unblinding_IMP })

    Area_1_Risk_unblinding_IMP <- reactive({ 0.5*as.numeric(A2_Risk_unblinding_IMP())*input$Prob_Risk_unblinding_IMP*sin(120)  }) 
 Area_2_Risk_unblinding_IMP <- reactive({ 0.5*as.numeric(A2_Risk_unblinding_IMP())*input$Det_Risk_unblinding_IMP*sin(120)  }) 

Area_3_Risk_unblinding_IMP <- reactive({ 0.5*input$Prob_Risk_unblinding_IMP*input$Det_Risk_unblinding_IMP*sin(120)  }) 
Area_4_Risk_unblinding_IMP <-  reactive({ Area_1_Risk_unblinding_IMP()+Area_2_Risk_unblinding_IMP()+Area_3_Risk_unblinding_IMP()  }) 

     
     
       Var1 <-as.numeric(A2_Risk_unblinding_IMP())
         Var2 <-input$Prob_Risk_unblinding_IMP
         Var3 <- input$Det_Risk_unblinding_IMP
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Risk_unblinding_IMP())                           
                                     text(x = 0.5, y = 0.8, paste(round(Area_4_Risk_unblinding_IMP())), cex = 1.6, col = "black")
  
         
         
         
         
        dev.off()
   }
  )
```


## **`r colorize("Protocol compliance- Safety reporting", "mediumblue")`**
### **1. Having a non efficient reporting/uncomplete of all adverse events being reported**
```{r echo=FALSE}
 inputPanel(

    textInput("Sponsor_adverse_reported", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Sponsor_adverse_reported", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Sponsor_adverse_reported", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Sponsor_adverse_reported", "Detectabilty", NA, min = 1, max = 2),
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Sponsor_adverse_reported", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Sponsor_adverse_reported <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Sponsor_adverse_reported))
      
      
    })



 title_Sponsor_adverse_reported= renderText({ input$Sponsor_adverse_reported })

   Area_1_Sponsor_adverse_reported <- reactive({ 0.5*as.numeric(A2_Sponsor_adverse_reported())*input$Prob_Sponsor_adverse_reported*sin(120)  }) 
 Area_2_Sponsor_adverse_reported <- reactive({ 0.5*as.numeric(A2_Sponsor_adverse_reported())*input$Det_Sponsor_adverse_reported*sin(120)  }) 

Area_3_Sponsor_adverse_reported<- reactive({ 0.5*input$Prob_Sponsor_adverse_reported*input$Det_Sponsor_adverse_reported*sin(120)  }) 
Area_4_Sponsor_adverse_reported <-  reactive({ round(( Area_1_Sponsor_adverse_reported()+Area_2_Sponsor_adverse_reported()+Area_3_Sponsor_adverse_reported()) /15.09589*100,
        digits = 0 )  }) 
 
 renderPlot({
  
       Var1 <-as.numeric(A2_Sponsor_adverse_reported())
         Var2 <-input$Prob_Sponsor_adverse_reported
         Var3 <- input$Det_Sponsor_adverse_reported
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Sponsor_adverse_reported())                           
              text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Sponsor_adverse_reported()))=="NA", "Total Area",
                                  paste(round(Area_4_Sponsor_adverse_reported()))), cex = 1.6, col = "black")

   })
 
 
  A2_Sponsor_adverse_reported_Monitoring <- renderText({    
      
    Monitoring_Sponsor_adverse_reported <- input$inCheckboxGroup_Monitoring_Techniques_Sponsor_adverse_reported
      
    })

```


### **2. Violating instructions for SAE. Follow-up reports won't be followed**
```{r echo=FALSE}
 
inputPanel(

    textInput("Instruction_SAE_report", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Instruction_SAE_report", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Instruction_SAE_report", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Instruction_SAE_report", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Instruction_SAE_report", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Instruction_SAE_report <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Instruction_SAE_report))
      
      
    })



 title_Instruction_SAE_report= renderText({ input$Instruction_SAE_report })


 
     Area_1_Instruction_SAE_report <- reactive({ 0.5*as.numeric(A2_Instruction_SAE_report())*input$Prob_Instruction_SAE_report*sin(120)  }) 
 Area_2_Instruction_SAE_report <- reactive({ 0.5*as.numeric(A2_Instruction_SAE_report())*input$Det_Instruction_SAE_report*sin(120)  }) 

Area_3_Instruction_SAE_report <- reactive({ 0.5*input$Prob_Instruction_SAE_report*input$Det_Instruction_SAE_report*sin(120)  }) 
Area_4_Instruction_SAE_report <-  reactive({ round(( Area_1_Instruction_SAE_report()+Area_2_Instruction_SAE_report()+Area_3_Instruction_SAE_report() ) /15.09589*100,
        digits = 0 ) }) 


  renderPlot({
   
   
       Var1 <-as.numeric(A2_Instruction_SAE_report())
         Var2 <-input$Prob_Instruction_SAE_report
         Var3 <- input$Det_Instruction_SAE_report
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Instruction_SAE_report())                           
             text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Instruction_SAE_report()))=="NA", "Total Area",
                                  paste(round(Area_4_Instruction_SAE_report()))), cex = 1.6, col = "black")

   })
 
  A2_Instruction_SAE_report_Monitoring <- renderText({    
      
    Monitoring_Instruction_SAE_report <- input$inCheckboxGroup_Monitoring_Techniques_Instruction_SAE_report
      
    })

```


### **3. Inadequate SAE documentation and reporting**
```{r echo=FALSE}
 
inputPanel(

    textInput("Inadequate_SAE_doc", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Inadequate_SAE_doc", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Inadequate_SAE_doc", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Inadequate_SAE_doc", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Inadequate_SAE_doc", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Inadequate_SAE_doc <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Inadequate_SAE_doc))
      
      
    })



 title_Inadequate_SAE_doc= renderText({ input$Inadequate_SAE_doc })

 Area_1_Inadequate_SAE_doc <- reactive({ 0.5*as.numeric(A2_Inadequate_SAE_doc())*input$Prob_Inadequate_SAE_doc*sin(120)  }) 
 Area_2_Inadequate_SAE_doc <- reactive({ 0.5*as.numeric(A2_Inadequate_SAE_doc())*input$Det_Inadequate_SAE_doc*sin(120)  }) 

Area_3_Inadequate_SAE_doc <- reactive({ 0.5*input$Prob_Inadequate_SAE_doc*input$Det_Inadequate_SAE_doc*sin(120)  }) 
Area_4_Inadequate_SAE_doc <-  reactive({ round(( Area_1_Inadequate_SAE_doc()+Area_2_Inadequate_SAE_doc()+Area_3_Inadequate_SAE_doc() ) /15.09589*100,
        digits = 0 ) }) 
 
  renderPlot({
   
         Var1 <-as.numeric(A2_Inadequate_SAE_doc())
         Var2 <-input$Prob_Inadequate_SAE_doc
         Var3 <- input$Det_Inadequate_SAE_doc
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inadequate_SAE_doc())                           
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Inadequate_SAE_doc()))=="NA", "Total Area",
                                  paste(round(Area_4_Inadequate_SAE_doc()))), cex = 1.6, col = "black")
   })
 
  A2_Inadequate_SAE_doc_Monitoring <- renderText({    
      
    Monitoring_Inadequate_SAE_doc <- input$inCheckboxGroup_Monitoring_Techniques_Inadequate_SAE_doc
      
    })

```


```{r PDF_Protocol_compliance_safety_Reporting, echo=FALSE}

 mainPanel( downloadButton(outputId = "PDF_Protocol_compliance_safety_Reporting", label = "Download Protocol compliance/Safety Report"))


    output$PDF_Protocol_compliance_safety_Reporting <- downloadHandler(
   filename = function() { paste("Protocol compliance/others Report", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
        # par(mfrow=c(2,3), mar=c(0,0,0,0), oma=c(5.1,4,1.5,0.5))
         par(mfrow=c(3,1))

      
         
         # 1st 
         
         
 title_Sponsor_adverse_reported= renderText({ input$Sponsor_adverse_reported })
    Area_1_Sponsor_adverse_reported <- reactive({ 0.5*as.numeric(A2_Sponsor_adverse_reported())*input$Prob_Sponsor_adverse_reported*sin(120)  }) 
 Area_2_Sponsor_adverse_reported <- reactive({ 0.5*as.numeric(A2_Sponsor_adverse_reported())*input$Det_Sponsor_adverse_reported*sin(120)  }) 

Area_3_Sponsor_adverse_reported<- reactive({ 0.5*input$Prob_Sponsor_adverse_reported*input$Det_Sponsor_adverse_reported*sin(120)  }) 
Area_4_Sponsor_adverse_reported <-  reactive({ Area_1_Sponsor_adverse_reported()+Area_2_Sponsor_adverse_reported()+Area_3_Sponsor_adverse_reported()  }) 

       Var1 <-as.numeric(A2_Sponsor_adverse_reported())
         Var2 <-input$Prob_Sponsor_adverse_reported
         Var3 <- input$Det_Sponsor_adverse_reported
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Sponsor_adverse_reported())                           
                                        text(x = 0.5, y = 0.8, paste(round(Area_4_Sponsor_adverse_reported())), cex = 1.6, col = "black")

         
         
         # 2nd
         
 title_Instruction_SAE_report= renderText({ input$Instruction_SAE_report })
    Area_1_Instruction_SAE_report <- reactive({ 0.5*as.numeric(A2_Instruction_SAE_report())*input$Prob_Instruction_SAE_report*sin(120)  }) 
 Area_2_Instruction_SAE_report <- reactive({ 0.5*as.numeric(A2_Instruction_SAE_report())*input$Det_Instruction_SAE_report*sin(120)  }) 

Area_3_Instruction_SAE_report <- reactive({ 0.5*input$Prob_Instruction_SAE_report*input$Det_Instruction_SAE_report*sin(120)  }) 
Area_4_Instruction_SAE_report <-  reactive({ Area_1_Instruction_SAE_report()+Area_2_Instruction_SAE_report()+Area_3_Instruction_SAE_report()  }) 

     
       Var1 <-as.numeric(A2_Instruction_SAE_report())
         Var2 <-input$Prob_Instruction_SAE_report
         Var3 <- input$Det_Instruction_SAE_report
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Instruction_SAE_report())                           
                                        text(x = 0.5, y = 0.8, paste(round(Area_4_Instruction_SAE_report())), cex = 1.6, col = "black")
         
         
         # 3rd 
         title_Inadequate_SAE_doc= renderText({ input$Inadequate_SAE_doc })
   
    Area_1_Inadequate_SAE_doc <- reactive({ 0.5*as.numeric(A2_Inadequate_SAE_doc())*input$Prob_Inadequate_SAE_doc*sin(120)  }) 
 Area_2_Inadequate_SAE_doc <- reactive({ 0.5*as.numeric(A2_Inadequate_SAE_doc())*input$Det_Inadequate_SAE_doc*sin(120)  }) 

Area_3_Inadequate_SAE_doc <- reactive({ 0.5*input$Prob_Inadequate_SAE_doc*input$Det_Inadequate_SAE_doc*sin(120)  }) 
Area_4_Inadequate_SAE_doc <-  reactive({ Area_1_Inadequate_SAE_doc()+Area_2_Inadequate_SAE_doc()+Area_3_Inadequate_SAE_doc()  }) 

     
       Var1 <-as.numeric(A2_Inadequate_SAE_doc())
         Var2 <-input$Prob_Inadequate_SAE_doc
         Var3 <- input$Det_Inadequate_SAE_doc
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Inadequate_SAE_doc())                           
                                        text(x = 0.5, y = 0.8, paste(round(Area_4_Inadequate_SAE_doc())), cex = 1.6, col = "black")

   
         
       dev.off()
   }
  )

```

## **`r colorize("Protocol compliance- Assessment of efficacy", "mediumblue")`**
### **1. Site does not strictly follow the protocol criteria that needs to be used to assess the disease status**
```{r echo=FALSE}

inputPanel(

    textInput("site_protocol_strictly_follow", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_site_protocol_strictly_follow", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_site_protocol_strictly_follow", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_site_protocol_strictly_follow", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_site_protocol_strictly_follow", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_site_protocol_strictly_follow <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_site_protocol_strictly_follow))
      
      
    })



 title_site_protocol_strictly_follow= renderText({ input$site_protocol_strictly_follow })


 
     Area_1_site_protocol_strictly_follow <- reactive({ 0.5*as.numeric(A2_site_protocol_strictly_follow())*input$Prob_site_protocol_strictly_follow*sin(120)  }) 
 Area_2_site_protocol_strictly_follow <- reactive({ 0.5*as.numeric(A2_site_protocol_strictly_follow())*input$Det_site_protocol_strictly_follow*sin(120)  }) 

Area_3_site_protocol_strictly_follow <- reactive({ 0.5*input$Prob_site_protocol_strictly_follow*input$Det_site_protocol_strictly_follow*sin(120)  }) 
Area_4_site_protocol_strictly_follow <-  reactive({ round(( Area_1_site_protocol_strictly_follow()+Area_2_site_protocol_strictly_follow()+Area_3_site_protocol_strictly_follow()) /15.09589*100,
        digits = 0 )  }) 

  renderPlot({
   
   
       Var1 <-as.numeric(A2_site_protocol_strictly_follow())
         Var2 <-input$Prob_site_protocol_strictly_follow
         Var3 <- input$Det_site_protocol_strictly_follow
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_site_protocol_strictly_follow())                           
       text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_site_protocol_strictly_follow()))=="NA", "Total Area",
                                  paste(round(Area_4_site_protocol_strictly_follow()))), cex = 1.6, col = "black")

   })
 
   A2_site_protocol_strictly_follow_Monitoring <- renderText({    
      
    Monitoring_site_protocol_strictly_follow <- input$inCheckboxGroup_Monitoring_Techniques_site_protocol_strictly_follow
      
    })
  

```

### **2. The procedures for the primary end point assessment for patients might not be strictly followed as required by the clinical protocol**
```{r echo=FALSE}
 
inputPanel(

    textInput("Endpoint_assessment__required_protocol", "such as ", ""),
    
   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup_Endpoint_assessment__required_protocol", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob_Endpoint_assessment__required_protocol", "Probability", NA, min = 1, max = 5), 
  numericInput("Det_Endpoint_assessment__required_protocol", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_Endpoint_assessment__required_protocol", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2_Endpoint_assessment__required_protocol <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup_Endpoint_assessment__required_protocol))
      
      
    })



 title_Endpoint_assessment__required_protocol= renderText({ input$Endpoint_assessment__required_protocol })

 
    Area_1_Endpoint_assessment__required_protocol <- reactive({ 0.5*as.numeric(A2_Endpoint_assessment__required_protocol())*input$Prob_Endpoint_assessment__required_protocol*sin(120)  }) 
 Area_2_Endpoint_assessment__required_protocol <- reactive({ 0.5*as.numeric(A2_Endpoint_assessment__required_protocol())*input$Det_Endpoint_assessment__required_protocol*sin(120)  }) 

Area_3_Endpoint_assessment__required_protocol <- reactive({ 0.5*input$Prob_Endpoint_assessment__required_protocol*input$Det_Endpoint_assessment__required_protocol*sin(120)  }) 
Area_4_Endpoint_assessment__required_protocol <-  reactive({ round(( Area_1_Endpoint_assessment__required_protocol()+Area_2_Endpoint_assessment__required_protocol()+Area_3_Endpoint_assessment__required_protocol() ) /15.09589*100,
        digits = 0 ) }) 
 
 
 renderPlot({
   
        Var1 <-as.numeric(A2_Endpoint_assessment__required_protocol())
         Var2 <-input$Prob_Endpoint_assessment__required_protocol
         Var3 <- input$Det_Endpoint_assessment__required_protocol
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Endpoint_assessment__required_protocol())                           
       text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Endpoint_assessment__required_protocol()))=="NA", "Total Area",
                                  paste(round(Area_4_Endpoint_assessment__required_protocol()))), cex = 1.6, col = "black")

   })
 
   A2_Endpoint_assessment__required_protocol_Monitoring <- renderText({    
      
    Monitoring_Endpoint_assessment__required_protocol<- input$inCheckboxGroup_Monitoring_Techniques_Endpoint_assessment__required_protocol
      
    })
  

```

```{r PDF_Protocol_compliance_assessment_efficacy_Reporting, echo=FALSE}

 mainPanel( downloadButton(outputId = "PDF_Protocol_compliance_assessment_efficacy_Reporting", label = "Download Protocol compliance/Assessment of efficacy Report"))


    output$PDF_Protocol_compliance_assessment_efficacy_Reporting <- downloadHandler(
   filename = function() { paste("Protocol compliance/others Report", 'pdf', sep='.') },
   content = function(file) {
     pdf(file)
         par(mfrow=c(2,1))
        
         # 1st
   
     title_site_protocol_strictly_follow= renderText({ input$site_protocol_strictly_follow })

    Area_1_site_protocol_strictly_follow <- reactive({ 0.5*as.numeric(A2_site_protocol_strictly_follow())*input$Prob_site_protocol_strictly_follow*sin(120)  }) 
 Area_2_site_protocol_strictly_follow <- reactive({ 0.5*as.numeric(A2_site_protocol_strictly_follow())*input$Det_site_protocol_strictly_follow*sin(120)  }) 

Area_3_site_protocol_strictly_follow <- reactive({ 0.5*input$Prob_site_protocol_strictly_follow*input$Det_site_protocol_strictly_follow*sin(120)  }) 
Area_4_site_protocol_strictly_follow <-  reactive({ Area_1_site_protocol_strictly_follow()+Area_2_site_protocol_strictly_follow()+Area_3_site_protocol_strictly_follow()  }) 

     
       Var1 <-as.numeric(A2_site_protocol_strictly_follow())
         Var2 <-input$Prob_site_protocol_strictly_follow
         Var3 <- input$Det_site_protocol_strictly_follow
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_site_protocol_strictly_follow())                           
                                           text(x = 0.5, y = 0.8, paste(round(Area_4_site_protocol_strictly_follow())), cex = 1.6, col = "black")
         
         
         # 2nd
         
         
 title_Endpoint_assessment__required_protocol= renderText({ input$Endpoint_assessment__required_protocol })


    Area_1_Endpoint_assessment__required_protocol <- reactive({ 0.5*as.numeric(A2_Endpoint_assessment__required_protocol())*input$Prob_Endpoint_assessment__required_protocol*sin(120)  }) 
 Area_2_Endpoint_assessment__required_protocol <- reactive({ 0.5*as.numeric(A2_Endpoint_assessment__required_protocol())*input$Det_Endpoint_assessment__required_protocol*sin(120)  }) 

Area_3_Endpoint_assessment__required_protocol <- reactive({ 0.5*input$Prob_Endpoint_assessment__required_protocol*input$Det_Endpoint_assessment__required_protocol*sin(120)  }) 
Area_4_Endpoint_assessment__required_protocol <-  reactive({ Area_1_Endpoint_assessment__required_protocol()+Area_2_Endpoint_assessment__required_protocol()+Area_3_Endpoint_assessment__required_protocol()  }) 

   
     
       Var1 <-as.numeric(A2_Endpoint_assessment__required_protocol())
         Var2 <-input$Prob_Endpoint_assessment__required_protocol
         Var3 <- input$Det_Endpoint_assessment__required_protocol
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_Endpoint_assessment__required_protocol())                           
              text(x = 0.5, y = 0.8, paste(round(Area_4_Endpoint_assessment__required_protocol())), cex = 1.6, col = "black")
              
      #    text(x =0.4, y = 2, paste("Protocol compliance/Assessment/n of efficacy Report"), cex = 1.6, col = "black")
                                
         
       dev.off()
   }
  )

```


## **`r colorize("Additional Risks", "mediumblue")`**
```{r risk1, echo=FALSE}




inputPanel(

    textInput("risk1", "Risk 1", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

  
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob1", "Probability", NA, min = 1, max = 5), 
  numericInput("Det1", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk1", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A1 <- renderText({    
      
    Imp1 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })

#renderPrint(A1())

 title_1= renderText({ input$risk1 })

    Area_1_Risk1 <- reactive({ 0.5*as.numeric(A1())*input$Prob1*sin(120)  }) 
 Area_2_Risk1 <- reactive({ 0.5*as.numeric(A1())*input$Det1*sin(120)  }) 

Area_3_Risk1 <- reactive({ 0.5*input$Prob1*input$Det1*sin(120)  }) 
Area_4_Risk1 <-  reactive({ round(( Area_1_Risk1()+Area_2_Risk1()+Area_3_Risk1()) /15.09589*100,
        digits = 0 )  }) 
 
  renderPlot({
        Var1 <-as.numeric(A1())
         Var2 <-input$Prob1
         Var3 <- input$Det1
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_1())
          text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk1()))=="NA", "Total Area", paste(round(Area_4_Risk1()))), cex = 1.6, col = "black")

   
   })
 
 
 A2_risk1_Monitoring <- renderText({    
      
    Monitoring_ <- input$inCheckboxGroup_Monitoring_Techniques_risk1
      
    })
```


```{r risk2, echo=FALSE}




inputPanel(

    textInput("risk2", "Risk 2", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob2", "Probability", NA, min = 1, max = 5), 
  numericInput("Det2", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk2", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A2 <- renderText({    
      
    Imp2 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_2= renderText({ input$risk2 })

  Area_1_Risk2 <- reactive({ 0.5*as.numeric(A2())*input$Prob2*sin(120)  }) 
 Area_2_Risk2 <- reactive({ 0.5*as.numeric(A2())*input$Det2*sin(120)  }) 

Area_3_Risk2 <- reactive({ 0.5*input$Prob2*input$Det2*sin(120)  }) 
Area_4_Risk2 <-  reactive({ round((Area_1_Risk2()+Area_2_Risk2()+Area_3_Risk2() ) /15.09589*100,
        digits = 0 )  }) 
 
 renderPlot({
   
    
          Var1 <-as.numeric(A2())
         Var2 <-input$Prob2
         Var3 <- input$Det2
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_2()) 
 text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk2()))=="NA", "Total Area", paste(round(Area_4_Risk2()))), cex = 1.6, col = "black")

         
   
   })
 
 
 A2_risk2_Monitoring <- renderText({    
      
    Monitoring_risk2 <- input$inCheckboxGroup_Monitoring_Techniques_risk2
      
    })
```



```{r risk3, echo=FALSE}




inputPanel(

    textInput("risk3", "Risk 3", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob3", "Probability", NA, min = 1, max = 5), 
  numericInput("Det3", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk3", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A3 <- renderText({    
      
    Imp3 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_3= renderText({ input$risk3 })

    Area_1_Risk3 <- reactive({ 0.5*as.numeric(A3())*input$Prob3*sin(120)  }) 
 Area_2_Risk3 <- reactive({ 0.5*as.numeric(A3())*input$Det3*sin(120)  }) 

Area_3_Risk3 <- reactive({ 0.5*input$Prob3*input$Det3*sin(120)  }) 
Area_4_Risk3 <-  reactive({ round(( Area_1_Risk3()+Area_2_Risk3()+Area_3_Risk3() ) /15.09589*100,
        digits = 0 )  }) 
 
  renderPlot({

       Var1 <-as.numeric(A3())
         Var2 <-input$Prob3
         Var3 <- input$Det3
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_3())  
          text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk3()))=="NA", "Total Area", paste(round(Area_4_Risk3()))), cex = 1.6, col = "black")
   
   })
 
 A2_risk3_Monitoring <- renderText({    
      
    Monitoring_risk3 <- input$inCheckboxGroup_Monitoring_Techniques_risk3
      
    })
```




```{r risk4, echo=FALSE}




inputPanel(

    textInput("risk4", "Risk 4", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob4", "Probability", NA, min = 1, max = 5), 
  numericInput("Det4", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk4", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A4 <- renderText({    
      
    Imp4 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_4= renderText({ input$risk4 })


      Area_1_Risk4 <- reactive({ 0.5*as.numeric(A4())*input$Prob4*sin(120)  }) 
 Area_2_Risk4 <- reactive({ 0.5*as.numeric(A4())*input$Det4*sin(120)  }) 

Area_3_Risk4 <- reactive({ 0.5*input$Prob4*input$Det4*sin(120)  }) 
Area_4_Risk4 <-  reactive({ round((Area_1_Risk4()+Area_2_Risk4()+Area_3_Risk4()  ) /15.09589*100,
        digits = 0 )}) 
 
  renderPlot({
   
       Var1 <-as.numeric(A4())
         Var2 <-input$Prob4
         Var3 <- input$Det4
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_4())                           
     text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk4()))=="NA", "Total Area", paste(round(Area_4_Risk4()))), cex = 1.6, col = "black")
   })
 
 A2_risk4_Monitoring <- renderText({    
      
    Monitoring_risk4 <- input$inCheckboxGroup_Monitoring_Techniques_risk4
      
    })
```




```{r risk5, echo=FALSE}




inputPanel(

    textInput("risk5", "Risk 5", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob5", "Probability", NA, min = 1, max = 5), 
  numericInput("Det5", "Detectabilty", NA, min = 1, max = 2), 
  checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk5", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A5 <- renderText({    
      
    Imp5 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_5= renderText({ input$risk5 })


      Area_1_Risk5 <- reactive({ 0.5*as.numeric(A5())*input$Prob5*sin(120)  }) 
 Area_2_Risk5 <- reactive({ 0.5*as.numeric(A5())*input$Det5*sin(120)  }) 

Area_3_Risk5 <- reactive({ 0.5*input$Prob5*input$Det5*sin(120)  }) 
Area_4_Risk5 <-  reactive({ round((Area_1_Risk5()+Area_2_Risk5()+Area_3_Risk5() ) /15.09589*100,
        digits = 0 ) }) 
 
  renderPlot({
   
   
     Var1 <-as.numeric(A5())
         Var2 <-input$Prob5
         Var3 <- input$Det5
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_5())                           
     text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk5()))=="NA", "Total Area", paste(round(Area_4_Risk5()))), cex = 1.6, col = "black")
   })
 
 A2_risk5_Monitoring <- renderText({    
      
    Monitoring_risk5 <- input$inCheckboxGroup_Monitoring_Techniques_risk5
      
    })
```

```{r risk6, echo=FALSE}




inputPanel(

    textInput("risk6", "Risk 6", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob6", "Probability", NA, min = 1, max = 5), 
  numericInput("Det6", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk6", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A6 <- renderText({    
      
    Imp6 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_6= renderText({ input$risk6 })

        Area_1_Risk6 <- reactive({ 0.5*as.numeric(A6())*input$Prob6*sin(120)  }) 
 Area_2_Risk6 <- reactive({ 0.5*as.numeric(A6())*input$Det6*sin(120)  }) 

Area_3_Risk6 <- reactive({ 0.5*input$Prob6*input$Det6*sin(120)  }) 
Area_4_Risk6 <-  reactive({ round((Area_1_Risk6()+Area_2_Risk6()+Area_3_Risk6()  ) /15.09589*100,
        digits = 0 )})
 
 renderPlot({
   
        Var1 <-as.numeric(A6())
         Var2 <-input$Prob6
         Var3 <- input$Det6
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_6())
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk6()))=="NA", "Total Area", paste(round(Area_4_Risk6()))), cex = 1.6, col = "black")
   
   })
 
 A2_risk6_Monitoring <- renderText({    
      
    Monitoring_risk6 <- input$inCheckboxGroup_Monitoring_Techniques_risk6
      
    })
```





```{r risk7, echo=FALSE}




inputPanel(

    textInput("risk7", "Risk 7", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob7", "Probability", NA, min = 1, max = 5), 
  numericInput("Det7", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_receiptimp", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A7 <- renderText({    
      
    Imp7 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_7= renderText({ input$risk7 })


     Area_1_Risk7 <- reactive({ 0.5*as.numeric(A7())*input$Prob7*sin(120)  }) 
 Area_2_Risk7 <- reactive({ 0.5*as.numeric(A7())*input$Det7*sin(120)  }) 

Area_3_Risk7 <- reactive({ 0.5*input$Prob7*input$Det7*sin(120)  }) 
Area_4_Risk7 <-  reactive({ round((Area_1_Risk7()+Area_2_Risk7()+Area_3_Risk7()) /15.09589*100,
        digits = 0 )  })

  renderPlot({
   

       Var1 <-as.numeric(A7())
         Var2 <-input$Prob7
         Var3 <- input$Det7
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_7())
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk7()))=="NA", "Total Area", paste(round(Area_4_Risk7()))), cex = 1.6, col = "black")
   
   })
 
 A2_risk7_Monitoring <- renderText({    
      
    Monitoring_risk7 <- input$inCheckboxGroup_Monitoring_Techniques_risk7
      
    })
```




```{r risk8, echo=FALSE}




inputPanel(

    textInput("risk8", "Risk 8", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob8", "Probability", NA, min = 1, max = 5), 
  numericInput("Det8", "Detectabilty", NA, min = 1, max = 2), 
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk8", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A8 <- renderText({    
      
    Imp8 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_8= renderText({ input$risk8 })

    Area_1_Risk8 <- reactive({ 0.5*as.numeric(A8())*input$Prob8*sin(120)  }) 
 Area_2_Risk8 <- reactive({ 0.5*as.numeric(A8())*input$Det8*sin(120)  }) 

Area_3_Risk8 <- reactive({ 0.5*input$Prob8*input$Det8*sin(120)  }) 
Area_4_Risk8 <-  reactive({ round((Area_1_Risk8()+Area_2_Risk8()+Area_3_Risk8() ) /15.09589*100,
        digits = 0 ) })
 
 renderPlot({
   
   
       Var1 <-as.numeric(A8())
         Var2 <-input$Prob8
         Var3 <- input$Det8
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_8())     
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk8()))=="NA", "Total Area", paste(round(Area_4_Risk8()))), cex = 1.6, col = "black")
   
   })
 
 A2_risk8_Monitoring <- renderText({    
      
    Monitoring_risk8 <- input$inCheckboxGroup_Monitoring_Techniques_risk8
      
    })
```





```{r risk9, echo=FALSE}

inputPanel(

    textInput("risk9", "Risk 9", ""),

         

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob9", "Probability", NA, min = 1, max = 5), 
  numericInput("Det9", "Detectabilty", NA, min = 1, max = 2), 
  
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk9", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A9 <- renderText({    
      
    Imp9 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_9= renderText({ input$risk9 })


        Area_1_Risk9 <- reactive({ 0.5*as.numeric(A9())*input$Prob9*sin(120)  }) 
 Area_2_Risk9 <- reactive({ 0.5*as.numeric(A9())*input$Det9*sin(120)  }) 
Area_3_Risk9 <- reactive({ 0.5*input$Prob9*input$Det9*sin(120)  }) 
Area_4_Risk9 <-  reactive({ round(( Area_1_Risk9()+Area_2_Risk9()+Area_3_Risk9() ) /15.09589*100,
        digits = 0 ) })
     
  renderPlot({
   
     Var1 <-as.numeric(A9())
         Var2 <-input$Prob9
         Var3 <- input$Det9
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_9())
     text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk9()))=="NA", "Total Area", paste(round(Area_4_Risk9()))), cex = 1.6, col = "black")
   
   
   })
 
 
 A2_risk9_Monitoring <- renderText({    
      
    Monitoring_risk9 <- input$inCheckboxGroup_Monitoring_Techniques_risk9
      
    })
```




```{r risk10, echo=FALSE}

inputPanel(

    textInput("risk10", "Risk 10", ""),

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob10", "Probability", NA, min = 1, max = 5), 
  numericInput("Det10", "Detectabilty", NA, min = 1, max = 2), 
  
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk10", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A10 <- renderText({    
      
    Imp10 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_10= renderText({ input$risk10 })

         Area_1_Risk10 <- reactive({ 0.5*as.numeric(A10())*input$Prob10*sin(120)  }) 
 Area_2_Risk10 <- reactive({ 0.5*as.numeric(A10())*input$Det10*sin(120)  }) 
Area_3_Risk10 <- reactive({ 0.5*input$Prob10*input$Det10*sin(120)  }) 
Area_4_Risk10 <-  reactive({ round(( Area_1_Risk10()+Area_2_Risk10()+Area_3_Risk10() ) /15.09589*100,
        digits = 0 ) })
 
 
 renderPlot({
   

     
       Var1 <-as.numeric(A10())
         Var2 <-input$Prob10
         Var3 <- input$Det10
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_10())  
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk10()))=="NA", "Total Area", paste(round(Area_4_Risk10()))), cex = 1.6, col = "black")
   
   
   })
 
 
 A2_risk10_Monitoring <- renderText({    
      
    Monitoring_risk10 <- input$inCheckboxGroup_Monitoring_Techniques_risk10
      
    })
```


```{r risk11, echo=FALSE, eval=FALSE}

inputPanel(

    textInput("risk11", "Risk 11", ""),

   # checkboxInput("safety", "Wellbeing/safety of subjects", TRUE),
    #checkboxInput("reliability", "Reliability of data", TRUE),
    #checkboxInput("compliance", "GCP/protocol compliance", TRUE),
     checkboxGroupInput("inCheckboxGroup", "Risk has an Impact on",
                    choiceNames=c("Wellbeing/safety of subjects","Reliability of data", "GCP/protocol compliance"), 
                    choiceValues = as.numeric(c(3,2,1))), 

    
  #  numericInput("Imp1", "Impact:", NA, min = 1, max = 2),  
   numericInput("Prob11", "Probability", NA, min = 1, max = 5), 
  numericInput("Det11", "Detectabilty", NA, min = 1, max = 2), 
  
   checkboxGroupInput("inCheckboxGroup_Monitoring_Techniques_risk11", "Monitoring Technique",
                    choiceNames=c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally"), 
                    choiceValues = as.character(c("Onsite Monitoring","Remote Monitoring", "Both - Occasionally")))

         )



  A11 <- renderText({    
      
    Imp10 <-  sum( as.numeric(input$inCheckboxGroup))
      
      
    })



 title_11= renderText({ input$risk10 })
 
   Area_1_Risk11 <- reactive({ 0.5*as.numeric(A11())*input$Prob11*sin(120)  }) 
 Area_2_Risk11 <- reactive({ 0.5*as.numeric(A11())*input$Det11*sin(120)  }) 
Area_3_Risk11 <- reactive({ 0.5*input$Prob11*input$Det11*sin(120)  }) 
Area_4_Risk11 <-  reactive({ Area_1_Risk11()+Area_2_Risk11()+Area_3_Risk11()  })

renderPlot({
   
    
       Var1 <-as.numeric(A11())
         Var2 <-input$Prob11
         Var3 <- input$Det11
         C <- data.frame(Risk=c("Impact", "Probability", "Detectability"),  risk_A=c(Var1, Var2,
                                                                                     Var3))
         D <- C %>% pivot_wider(names_from = Risk, values_from = risk_A)
         D <- rbind(c(6,5,2), rep(0), D)
         
         radarchart(D, axistype=2, title=title_11())  
         text(x = 0.8, y = 0.6, ifelse(paste(round(Area_4_Risk11()))=="NA", "Total Area", paste(round(Area_4_Risk11()))), cex = 1.6, col = "black")
   
   
   })
 
 
 A2_risk11_Monitoring <- renderText({    
      
    Monitoring_risk11 <- input$inCheckboxGroup_Monitoring_Techniques_risk11
      
    })
```



## **`r colorize("Overall Assessment", "mediumblue")`**

```{r echo=FALSE, error=FALSE, fig.height=0.5, eval=F}

renderPlot({
  
  Areas <- c(
    ## Essential Documents,
    Area_4_LACK_ESSENTIAL(), Area_4_Receipt_IMP(), Area_4_Records_blood(), Area_4_Incomplete_screening_documen(), 
    Area_4_Incomplete_screening_list(), Area_4_CRF_issue_copy(),
    # SOPs
    Area_4_SOPs_usage(), Area_4_SOPs_update(), Area_4_Sponsor_efficient_quality_management_system(), 
    # Source Documentation
    Area_4_Discrepancies_data(), Area_4_Missing_source_Documents(), Area_4_Lack_document_location(),
    # Qualification/Training
    Area_4_incomplete_training_documentation(), Area_4_lack_training_personnel_procedure(), 
    # Organization and personnel
    Area_4_signature_log(), Area_4_tasks_staff(),
    # Contract/Agreements
    Area_4_contract_incomplete(), Area_4_protocol_consistent(), Area_4_Responsibilities_ident(), 
    # Data management
    Area_4_Inappropriate_report_protocol(), Area_4_lab_report_submission(), 
    Area_4_DEcision_DMSB_site(), 
    # Monitoring
    Area_4_Monitor_number_defici_site(), Area_4_escalation_process_monitor(), Area_4_Monitoring_plan_follow(), 
    # Clinical Study Report
    Area_4_Inconsistencies_CSR_SD_DR(), Area_4_Inaccurate_CSR(), Area_4_Relevant_INfo_CSR(), 
    # Document Control
    Area_4_document_version_date(), Area_4_amendment_late_study(), 
    # Protocol compliance - selection criteria
    Area_4_inclusion_violation_criteria(), Area_4_Final_decision_records(), 
    # Reporting in CRF/diary
    Area_4_Discrepancies_medical_history(), Area_4_Corrections_CRF_sign(), Area_4_Data_CRF_Reported(), 
    # Protocol compliance - others
    Area_4_IMP_Concomitant_medication(), Area_4_Protocol_visit_window(), Area_4_Sponsor_system_deviation(), 
    Area_4_Risk_unblinding_IMP(), 
    # Protocol compliance- Safety reporting
    Area_4_Sponsor_adverse_reported(), Area_4_Instruction_SAE_report(), Area_4_Inadequate_SAE_doc(), 
    # Protocol compliance- Assessment of efficacy
    Area_4_site_protocol_strictly_follow(), Area_4_Endpoint_assessment__required_protocol(), 
    # Additional Risks
    Area_4_Risk1(), Area_4_Risk2(), Area_4_Risk3(), Area_4_Risk4(), Area_4_Risk5(), Area_4_Risk6(), 
    Area_4_Risk7(), Area_4_Risk8(), Area_4_Risk9(), Area_4_Risk10()  )
  
  Areas_average     <- mean(Areas, na.rm=T)
  plot.new()
    text(x = 0.5, y = 0.5, ifelse(paste(round(Areas_average))=="NA"| is.na(Areas_average), "Not all were completed", 
                                  paste("The overall assessement", round(Areas_average))), cex = 1.6, col = "black")
  
  
})

```

```{r echo=FALSE, error=FALSE, eval=F}
Areas <- reactive({ c(
    ## Essential Documents,
    Area_4_LACK_ESSENTIAL(), Area_4_Receipt_IMP(), Area_4_Records_blood(), Area_4_Incomplete_screening_documen(), 
    Area_4_Incomplete_screening_list(), Area_4_CRF_issue_copy(),
    # SOPs
    Area_4_SOPs_usage(), Area_4_SOPs_update(), Area_4_Sponsor_efficient_quality_management_system(), 
    # Source Documentation
    Area_4_Discrepancies_data(), Area_4_Missing_source_Documents(), Area_4_Lack_document_location(),
    # Qualification/Training
    Area_4_incomplete_training_documentation(), Area_4_lack_training_personnel_procedure(), 
    # Organization and personnel
    Area_4_signature_log(), Area_4_tasks_staff(),
    # Contract/Agreements
    Area_4_contract_incomplete(), Area_4_protocol_consistent(), Area_4_Responsibilities_ident(), 
    # Data management
    Area_4_Inappropriate_report_protocol(), Area_4_lab_report_submission(), 
    Area_4_DEcision_DMSB_site(), 
    # Monitoring
    Area_4_Monitor_number_defici_site(), Area_4_escalation_process_monitor(), Area_4_Monitoring_plan_follow(), 
    # Clinical Study Report
    Area_4_Inconsistencies_CSR_SD_DR(), Area_4_Inaccurate_CSR(), Area_4_Relevant_INfo_CSR(), 
    # Document Control
    Area_4_document_version_date(), Area_4_amendment_late_study(), 
    # Protocol compliance - selection criteria
    Area_4_inclusion_violation_criteria(), Area_4_Final_decision_records(), 
    # Reporting in CRF/diary
    Area_4_Discrepancies_medical_history(), Area_4_Corrections_CRF_sign(), Area_4_Data_CRF_Reported(), 
    # Protocol compliance - others
    Area_4_IMP_Concomitant_medication(), Area_4_Protocol_visit_window(), Area_4_Sponsor_system_deviation(), 
    Area_4_Risk_unblinding_IMP(), 
    # Protocol compliance- Safety reporting
    Area_4_Sponsor_adverse_reported(), Area_4_Instruction_SAE_report(), Area_4_Inadequate_SAE_doc(), 
    # Protocol compliance- Assessment of efficacy
    Area_4_site_protocol_strictly_follow(), Area_4_Endpoint_assessment__required_protocol(), 
    # Additional Risks
    Area_4_Risk1(), Area_4_Risk2(), Area_4_Risk3(), Area_4_Risk4(), Area_4_Risk5(), Area_4_Risk6(), 
    Area_4_Risk7(), Area_4_Risk8(), Area_4_Risk9(), Area_4_Risk10()  ) })

 Areas_average     <- reactive({ mean(Areas(), na.rm=T)  })
   renderText({    
         ifelse(paste(round(Areas_average()))=="NA"| is.na(Areas_average()), 
                "Once the assessment of the risk has been done, the average risk assessment will be modelled", 
   paste("The average risk assessement is", round(Areas_average())))
       
      })

```


```{r echo=FALSE, error=FALSE}
Df_output <- reactive({
  
  
   Risk_df <- data.frame( 
     Risk=c(
     ## Essential Documents
     "Missing/Lack of essential document(s)", "Receipt of IMP shipment to site (Delay, ect.)", 
     "Records of blood samples shipment to the central laboratories(Delay, etc.)", 
     "Having incomplete documentation", "Incomplete screening list (Not following screening appointments)", 
     "lack of contemporaneous independent copy of the CRF filed on site", 
     # SOPs
     "SOPs won’t be followed/used", 
     "SOPs won’t be updated as required", "The implementation of an efficient quality management system by the Sponsor", 
     # Source Documentation
     "Risk of having discrepancies between source data and data reported in the CSR", 
     "Having missing source documents", "Lack/Missing of document specifying location of source data", 
      # Qualification/Training
     "Incomplete training documentation", "lack of training of study personnel on trial related procedures", 
     # Organization and personnel
      "Incomplete site personnel signature log", "Tasks performed by unauthorized staff", 
      # Contract/Agreements
     "Incomplete contracts in place", "lack of consistency between contract and protocol", 
     "Responsibilities not clearly identified", 
      # Data management
     "System for reporting protocol violations", "Having late laboratory report submission to the site", "Decisions made by the DMSB and their communication to the site(Delay, etc)", 
     # Monitoring
     "Risk of not Identifying number of deficiencies on site by the Monitor", 
     "having unclear escalation process to resolve issues identified by monitor", 
     "Monitor not following monitoring plan", 
     # Clinical Study Report
     "Having inconsistencies between source data and data reported in the CSR", "Inaccurate information reported in CSR", "Having relevant information missing in the CSR", 
     # Document Control
     "Lack of version/date on the document", "Late introduction of amendments in the study",
      # Protocol compliance - selection criteria
    "Violation of inclusion criteria", 
    "Having missing documentation of the final decision about eligibility", 
    # Reporting in CRF/diary
    "Having disrepancies between source data such as medical history, concomitant medication etc. and the CRF for a sample of subjects
", "Having corrections on CRF that won’t not be signed and dated", 
    "Not reporting data in CRF in a timely manner", 
    # Protocol compliance - others
    "IMP and concomitant medication protocol deviations", "Protocol visits not being performed within the visit windows specified in the protocol", "Having a system that prospectively accepts deviations from the protocol", "Having insufficient maintenance of blinding procedure of the IMP", 
    # Protocol compliance- Safety reporting
    "Having a non efficient reporting/uncomplete of all adverse events being reported", 
    "Violating instructions for SAE. Follow-up reports won’t be followed", 
    "Inadequate SAE documentation and reporting",
    # Protocol compliance- Assessment of efficacy
    "Site does not strictly follow the protocol criteria that needs to be used to assess the disease status", 
    "The procedures for the primary end point assessment for patients might not be strictly followed as required by the clinical protocol",
    # Additional Risks
    title_1(), title_2(), title_3(), title_4(), title_5(), title_6(), title_7(), title_8(),
    title_9(), title_10()),
  ##################################################################################################
############################################################################################
#################################### Impact ###########################################
#######################################################################################
     `Impact`=c(   ## Essential Documents,
    A2_LACK_ESSENTIAL(), A2_Receipt_IMP(), A2_Records_blood(), A2_Incomplete_screening_documen(), 
    A2_Incomplete_screening_list(), A2_CRF_issue_copy(),
    # SOPs
    A2_SOPs_usage(), A2_SOPs_update(), A2_Sponsor_efficient_quality_management_system(), 
    # Source Documentation
    A2_Discrepancies_data(), A2_Missing_source_Documents(), A2_Lack_document_location(),
    # Qualification/Training
    A2_incomplete_training_documentation(), A2_lack_training_personnel_procedure(), 
    # Organization and personnel
    A2_signature_log(), A2_tasks_staff(),
    # Contract/Agreements
    A2_contract_incomplete(), A2_contract_protocol_consistent(), A2_Responsibilities_ident(), 
    # Data management
    A2_Inappropriate_report_protocol(), A2_lab_report_submission(), 
    A2_DEcision_DMSB_site(), 
    # Monitoring
    A2_Monitor_number_defici_site(), A2_escalation_process_monitor(), A2_Monitoring_plan_follow(), 
    # Clinical Study Report
    A2_Inconsistencies_CSR_SD_DR(), A2_Inaccurate_CSR(), A2_Relevant_INfo_CSR(), 
    # Document Control
    A2_document_version_date(), A2_amendment_late_study(), 
    # Protocol compliance - selection criteria
    A2_inclusion_violation_criteria(), A2_Final_decision_records(), 
    # Reporting in CRF/diary
    A2_Discrepancies_medical_history(), A2_Corrections_CRF_sign(), A2_Data_CRF_Reported(), 
    # Protocol compliance - others
    A2_IMP_Concomitant_medication(), A2_Protocol_visit_window(), A2_Sponsor_system_deviation(), 
    A2_Risk_unblinding_IMP(), 
    # Protocol compliance- Safety reporting
    A2_Sponsor_adverse_reported(), A2_Instruction_SAE_report(), A2_Inadequate_SAE_doc(), 
    # Protocol compliance- Assessment of efficacy
    A2_site_protocol_strictly_follow(), A2_Endpoint_assessment__required_protocol(), 
    # Additional Risks
    A1(), A2(), A3(), A4(), A5(), A6(), 
    A7(), A8(), A9(), A10()),
  ##################################################################################################
############################################################################################
#################################### Probability ###########################################
#######################################################################################

    `Probability`=c(   ## Essential Documents,
    input$Prob_LACK_ESSENTIAL, input$Prob_Receipt_IMP, input$Prob_Records_blood, input$Prob_Incomplete_screening_documen, 
    input$Prob_Incomplete_screening_list, input$Prob_CRF_issue_copy,
    # SOPs
    input$Prob_SOPs_usage, input$Prob_SOPs_update, input$Prob_Sponsor_efficient_quality_management_system, 
    # Source Documentation
    input$Prob_Discrepancies_data, input$Prob_Missing_source_Documents,  input$Prob_Lack_document_location,
    # Qualification/Training
     input$Prob_incomplete_training_documentation, input$Prob_lack_training_personnel_procedure, 
    # Organization and personnel
     input$Prob_signature_log, input$Prob_tasks_staff,
    # Contract/Agreements
    input$Prob_contract_incomplete, input$Prob_contract_protocol_consistent, input$Prob_Responsibilities_ident, 
    # Data management
    input$Prob_Inappropriate_report_protocol, input$Prob_lab_report_submission, 
    input$Prob_DEcision_DMSB_site, 
    # Monitoring
    input$Prob_Monitor_number_defici_site,  input$Prob_escalation_process_monitor, input$Prob_Monitoring_plan_follow, 
    # Clinical Study Report
    input$Prob_Inconsistencies_CSR_SD_DR, input$Prob_Inaccurate_CSR, input$Prob_Relevant_INfo_CSR, 
    # Document Control
    input$Prob_document_version_date, input$Prob_amendment_late_study, 
    # Protocol compliance - selection criteria
    input$Prob_inclusion_violation_criteria, input$Prob_Final_decision_records, 
    # Reporting in CRF/diary
    input$Prob_Discrepancies_medical_history,  input$Prob_Corrections_CRF_sign, input$Prob_Data_CRF_Reported, 
    # Protocol compliance - others
    input$Prob_IMP_Concomitant_medication, input$Prob_Protocol_visit_window, input$Prob_Sponsor_system_deviation, 
    input$Prob_Risk_unblinding_IMP, 
    # Protocol compliance- Safety reporting
    input$Prob_Sponsor_adverse_reported, input$Prob_Instruction_SAE_report, input$Prob_Inadequate_SAE_doc, 
    # Protocol compliance- Assessment of efficacy
    input$Prob_site_protocol_strictly_follow, input$Det_Endpoint_assessment__required_protocol, 
    # Additional Risks
    input$Prob1, input$Prob2, input$Prob3, input$Prob4, input$Prob5, input$Prob6, 
    input$Prob7, input$Prob8, input$Prob9, input$Prob10),

  ##################################################################################################
############################################################################################
#################################### Detectability ###########################################
#######################################################################################

    `Detectability`=c(   ## Essential Documents,
    input$Det_LACK_ESSENTIAL, input$Det_Receipt_IMP, input$Det_Records_blood, input$Det_Incomplete_screening_documen, 
    input$Det_Incomplete_screening_list, input$Det_CRF_issue_copy,
    # SOPs
    input$Det_SOPs_usage, input$Det_SOPs_update, input$Det_Sponsor_efficient_quality_management_system, 
    # Source Documentation
    input$Det_Discrepancies_data, input$Det_Missing_source_Documents,  input$Det_Lack_document_location,
    # Qualification/Training
     input$Det_incomplete_training_documentation, input$Det_lack_training_personnel_procedure, 
    # Organization and personnel
     input$Det_signature_log, input$Det_tasks_staff,
    # Contract/Agreements
    input$Det_contract_incomplete, input$Det_contract_protocol_consistent, input$Det_Responsibilities_ident, 
    # Data management
    input$Det_Inappropriate_report_protocol, input$Det_lab_report_submission, 
    input$Det_DEcision_DMSB_site, 
    # Monitoring
    input$Det_Monitor_number_defici_site,  input$Det_escalation_process_monitor, input$Det_Monitoring_plan_follow, 
    # Clinical Study Report
    input$Det_Inconsistencies_CSR_SD_DR, input$Det_Inaccurate_CSR, input$Det_Relevant_INfo_CSR, 
    # Document Control
    input$Det_document_version_date, input$Det_amendment_late_study, 
    # Protocol compliance - selection criteria
    input$Det_inclusion_violation_criteria, input$Det_Final_decision_records, 
    # Reporting in CRF/diary
    input$Det_Discrepancies_medical_history,  input$Det_Corrections_CRF_sign, input$Det_Data_CRF_Reported, 
    # Protocol compliance - others
    input$Det_IMP_Concomitant_medication, input$Det_Protocol_visit_window, input$Det_Sponsor_system_deviation, 
    input$Det_Risk_unblinding_IMP, 
    # Protocol compliance- Safety reporting
    input$Det_Sponsor_adverse_reported, input$Det_Instruction_SAE_report, input$Det_Inadequate_SAE_doc, 
    # Protocol compliance- Assessment of efficacy
    input$Det_site_protocol_strictly_follow, input$Det_Endpoint_assessment__required_protocol, 
    # Additional Risks
    input$Det1, input$Det2, input$Det3, input$Det4, input$Det5, input$Det6, 
    input$Det7, input$Det8, input$Det9, input$Det10),

Monitoring=c(
#Essential Documents (6)
A2_LACK_ESSENTIAL_Monitoring(), A2_recieptimp_Monitoring(), A2_REcords_blood_Monitoring(), A2_Incomplete_screening_documen_Monitoring(), A2_Incomplete_screening_documen_Monitoring(), A2_CRF_issue_copy_Monitoring(),
#SOPs (3)
A2_SOPs_usage_Monitoring(), A2_SOPs_update_Monitoring(),A2_Sponsor_efficient_quality_management_system_Monitoring(), 
#Source Documentation (3)
A2_Discrepancies_data_Monitoring(), A2_Missing_source_Documents_Monitoring(), A2_Lack_document_location_Monitoring(),
#Qualification/Training (2)
A2_incomplete_training_documentation_Monitoring(), A2_lack_training_personnel_procedure_Monitoring(),
#Organization and personnel (2)
A2_signature_log_Monitoring(), A2_tasks_staff_Monitoring(),
#Contract/Agreements (3)
A2_contract_incomplete_Monitoring(), A2_contract_protocol_consistent_Monitoring(), A2_Responsibilities_ident_Monitoring(),
#Data Managment (3)
A2_report_protocol_Monitoring(), A2_lab_report_submission_Monitoring(), A2_DEcision_DMSB_site_Monitoring(), 
#Monitoring (3)
A2_Monitor_number_defici_site_Monitoring(), A2_escalation_process_monitor_Monitoring(), A2_Monitoring_plan_follow_Monitoring(),
#Clinical Study Report (3)                          
A2_Inconsistencies_CSR_SD_DR_Monitoring(), A2_Inaccurate_CSR_Monitoring(),A2_Relevant_INfo_CSR_Monitoring(),   
#Document Control (2)                         
A2_document_version_date_Monitoring(), A2_amendment_late_study_Monitoring(),      
#Protocol compliance - selection criteria (2)
A2_inclusion_violation_criteria_Monitoring(),A2_Final_decision_records_Monitoring(),
#Reporting in CRF/diary (3)
A2_Discrepancies_medical_history_Monitoring(), A2_Corrections_CRF_sign_Monitoring(),A2_Data_CRF_Reported_Monitoring(),     
#Protocol compliance- others (4)   
A2_IMP_Concomitant_medication_Monitoring(),A2_Protocol_visit_window_Monitoring(),A2_Sponsor_system_deviation_Monitoring(),
A2_Risk_unblinding_IMP_Monitoring(),
#Protocol compliance- safety reporting (3)
A2_Sponsor_adverse_reported_Monitoring(),A2_Instruction_SAE_report_Monitoring(),
A2_Inadequate_SAE_doc_Monitoring(), 
#Protocol compliance- assessment of efficacy (2)
A2_site_protocol_strictly_follow_Monitoring(), A2_Endpoint_assessment__required_protocol_Monitoring(),
#Additional risk (10)
A2_risk1_Monitoring(), A2_risk2_Monitoring(), A2_risk3_Monitoring(), A2_risk4_Monitoring(),
A2_risk5_Monitoring(),A2_risk6_Monitoring(), A2_risk7_Monitoring(), A2_risk8_Monitoring(),
A2_risk9_Monitoring(), A2_risk10_Monitoring()

 ),
                      
    Score=c(
    ## Essential Documents,
    Area_4_LACK_ESSENTIAL(), Area_4_Receipt_IMP(), Area_4_Records_blood(), Area_4_Incomplete_screening_documen(), 
    Area_4_Incomplete_screening_list(), Area_4_CRF_issue_copy(),
    # SOPs
    Area_4_SOPs_usage(), Area_4_SOPs_update(), Area_4_Sponsor_efficient_quality_management_system(), 
    # Source Documentation
    Area_4_Discrepancies_data(), Area_4_Missing_source_Documents(), Area_4_Lack_document_location(),
    # Qualification/Training
    Area_4_incomplete_training_documentation(), Area_4_lack_training_personnel_procedure(), 
    # Organization and personnel
    Area_4_signature_log(), Area_4_tasks_staff(),
    # Contract/Agreements
    Area_4_contract_incomplete(), Area_4_protocol_consistent(), Area_4_Responsibilities_ident(), 
    # Data management
    Area_4_Inappropriate_report_protocol(), Area_4_lab_report_submission(), 
    Area_4_DEcision_DMSB_site(), 
    # Monitoring
    Area_4_Monitor_number_defici_site(), Area_4_escalation_process_monitor(), Area_4_Monitoring_plan_follow(), 
    # Clinical Study Report
    Area_4_Inconsistencies_CSR_SD_DR(), Area_4_Inaccurate_CSR(), Area_4_Relevant_INfo_CSR(), 
    # Document Control
    Area_4_document_version_date(), Area_4_amendment_late_study(), 
    # Protocol compliance - selection criteria
    Area_4_inclusion_violation_criteria(), Area_4_Final_decision_records(), 
    # Reporting in CRF/diary
    Area_4_Discrepancies_medical_history(), Area_4_Corrections_CRF_sign(), Area_4_Data_CRF_Reported(), 
    # Protocol compliance - others
    Area_4_IMP_Concomitant_medication(), Area_4_Protocol_visit_window(), Area_4_Sponsor_system_deviation(), 
    Area_4_Risk_unblinding_IMP(), 
    # Protocol compliance- Safety reporting
    Area_4_Sponsor_adverse_reported(), Area_4_Instruction_SAE_report(), Area_4_Inadequate_SAE_doc(), 
    # Protocol compliance- Assessment of efficacy
    Area_4_site_protocol_strictly_follow(), Area_4_Endpoint_assessment__required_protocol(), 
    # Additional Risks
    Area_4_Risk1(), Area_4_Risk2(), Area_4_Risk3(), Area_4_Risk4(), Area_4_Risk5(), Area_4_Risk6(), 
    Area_4_Risk7(), Area_4_Risk8(), Area_4_Risk9(), Area_4_Risk10()  )

  )  %>% filter(!(Risk=="" & is.na(Score)))  %>% mutate(Impact=ifelse(Impact==0, NA, Impact)) %>% 
    mutate(ID = as.character(row_number())) %>%  print
   
})

#renderTable(Df_output(), striped = TRUE, bordered = TRUE,  width = '100%')
#renderPrint(names(Df_output()))



```


```{r DF_out, echo=FALSE, eval=FALSE}
  
 renderDataTable(head(Df_output()), extensions = 'Buttons', 
                 options = list(dom = 'Bfrtip',
                 buttons = c('copy', 'csv', 'excel', 'pdf', 'print')), server = FALSE) 


# 
# renderDataTable(
#       DT::datatable(
#         Df_output(), 
#         extensions = 'Buttons',
#         options = list(
#           dom = 'Bfrtip',
#           lengthMenu = list(c(5, 15, -1), c('5', '15', 'All')),
#           pageLength = 15,
#           buttons = list(
#             list(
#               extend = "collection",
#               text = 'Show All',
#               action = DT::JS("function ( e, dt, node, config ) {
#                                     dt.page.len(-1);
#                                     dt.ajax.reload();
#                                 }")
#             )
#           )
#         )
#       ),extensions = 'Buttons', 
#    options = list(dom = 'Bfrtip',
#                 buttons = c('copy', 'csv', 'excel', 'pdf', 'print')) )


```


### **Overall risk assessment**
```{r echo=FALSE, error=FALSE}
Areas <- reactive({ c(
    ## Essential Documents,
    Area_4_LACK_ESSENTIAL(), Area_4_Receipt_IMP(), Area_4_Records_blood(), Area_4_Incomplete_screening_documen(), 
    Area_4_Incomplete_screening_list(), Area_4_CRF_issue_copy(),
    # SOPs
    Area_4_SOPs_usage(), Area_4_SOPs_update(), Area_4_Sponsor_efficient_quality_management_system(), 
    # Source Documentation
    Area_4_Discrepancies_data(), Area_4_Missing_source_Documents(), Area_4_Lack_document_location(),
    # Qualification/Training
    Area_4_incomplete_training_documentation(), Area_4_lack_training_personnel_procedure(), 
    # Organization and personnel
    Area_4_signature_log(), Area_4_tasks_staff(),
    # Contract/Agreements
    Area_4_contract_incomplete(), Area_4_protocol_consistent(), Area_4_Responsibilities_ident(), 
    # Data management
    Area_4_Inappropriate_report_protocol(), Area_4_lab_report_submission(), 
    Area_4_DEcision_DMSB_site(), 
    # Monitoring
    Area_4_Monitor_number_defici_site(), Area_4_escalation_process_monitor(), Area_4_Monitoring_plan_follow(), 
    # Clinical Study Report
    Area_4_Inconsistencies_CSR_SD_DR(), Area_4_Inaccurate_CSR(), Area_4_Relevant_INfo_CSR(), 
    # Document Control
    Area_4_document_version_date(), Area_4_amendment_late_study(), 
    # Protocol compliance - selection criteria
    Area_4_inclusion_violation_criteria(), Area_4_Final_decision_records(), 
    # Reporting in CRF/diary
    Area_4_Discrepancies_medical_history(), Area_4_Corrections_CRF_sign(), Area_4_Data_CRF_Reported(), 
    # Protocol compliance - others
    Area_4_IMP_Concomitant_medication(), Area_4_Protocol_visit_window(), Area_4_Sponsor_system_deviation(), 
    Area_4_Risk_unblinding_IMP(), 
    # Protocol compliance- Safety reporting
    Area_4_Sponsor_adverse_reported(), Area_4_Instruction_SAE_report(), Area_4_Inadequate_SAE_doc(), 
    # Protocol compliance- Assessment of efficacy
    Area_4_site_protocol_strictly_follow(), Area_4_Endpoint_assessment__required_protocol(), 
    # Additional Risks
    Area_4_Risk1(), Area_4_Risk2(), Area_4_Risk3(), Area_4_Risk4(), Area_4_Risk5(), Area_4_Risk6(), 
    Area_4_Risk7(), Area_4_Risk8(), Area_4_Risk9(), Area_4_Risk10()  ) })

 Areas_average     <- reactive({ mean(Areas(), na.rm=T)  })
   renderText({    
         ifelse(paste(round(Areas_average()))=="NA"| is.na(Areas_average()), 
                "Once the assessment of the risk has been done, the overall risk assessment will be displayed", 
   paste("The overall risk assessement is", round(Areas_average())))
       
      })

```

### **Assessment score of each individual risk**
```{r echo=FALSE} 
  fake_dat <- data.frame(Risk=c("Risk A", "Risk B", "Risk C", "Risk D"), Impact=c(6, 3, 2,4), Probability=c(5, 2, 1,3), Detectability=c(2,1,1,1), Score=c(100, 21, 10, 37)) %>% as.data.frame() %>% mutate(ID = as.character(row_number()))


dat_LIne_final <- reactive({
  
   tt <- if(nrow(dat_LIne()) >=1 ){
 dat_LIne()
}else{
  #print("data.frame contains data")
  fake_dat
}
   
})

risk_considered <- reactive({
  
  dat_LIne_final() %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact))  %>% mutate(ID = as.character(row_number()))
  
})


  
 renderDataTable(risk_considered(), extensions = 'Buttons', 
                 options = list(dom = 'Bfrtip',
                 buttons = c('copy', 'csv', 'excel', 'pdf', 'print')), server = FALSE)

```

### **Scores of individual risks**
```{r echo=FALSE} 

   renderPlot({
 
dat_LIne_final() %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact)) %>% pivot_longer(names_to = "input", values_to = "Score", cols = c(Impact, Probability, Detectability, Score)) %>% filter(input %in% c("Score")) %>% mutate(ID = as.character(row_number())) %>% ggplot(aes(reorder(ID, Score), Score, fill=Risk, label = paste0(Score, "%")) )+ geom_bar(stat="identity")+  
     geom_text(position = position_dodge(width = .9),    # move to center of bars
             # vjust =-0.8,    # nudge above top of bar+
              hjust=-0.5,
              size = 4)+ coord_flip()+
theme_bw()+ xlab("Risk ID")+ theme(legend.position = "none", axis.text.x=element_text(size=14, face = "bold"), axis.text.y=element_text(size=14, face = "bold"), axis.title.y =element_text(size=14, face = "bold"))

  
}
  
)
# 
#   fake_dat %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact)) %>% pivot_longer(names_to = "input", values_to = "Score", cols = c(Impact, Probability, Detectability, Score)) %>% filter(input %in% c("Score")) %>% ggplot(aes(reorder(Risk, Score), Score, fill=Risk, label = paste0(Score, "%")) )+ geom_bar(stat="identity")+
#      geom_text(position = position_dodge(width = .9),    # move to center of bars
#              # vjust =-0.8,    # nudge above top of bar+
#               hjust=-0.5,
#               size = 4)+ coord_flip()+
# theme_bw()+ xlab("")+ theme(legend.position = "none", axis.text.x=element_text(size=14, face = "bold"), axis.text.y=element_text(size=14, face = "bold"), axis.title.y =element_text(size=14, face = "bold"))
  
```

Overall scores (area under the radar) of each risk. 
<br>
```{r reporrttt, echo=FALSE, eval=TRUE}
 mainPanel( downloadButton(outputId = "GG_risk_individual", label = "Graph download"))

    output$GG_risk_individual <- downloadHandler(
    filename = function() {
        "plot.pdf"
    },
    content = function(file) {
       pdf(file, width = 10, height = 7)
      
gg_dat_individual <- dat_LIne_final() %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact)) %>% pivot_longer(names_to = "input", values_to = "Score", cols = c(Impact, Probability, Detectability, Score)) %>% filter(input %in% c("Score")) %>% mutate(ID = as.character(row_number())) %>% ggplot(aes(reorder(ID, Score), Score, fill=Risk, label = paste0(Score, "%")) )+ geom_bar(stat="identity")+  
     geom_text(position = position_dodge(width = .9),    # move to center of bars
             # vjust =-0.8,    # nudge above top of bar+
              hjust=-0.5,
              size = 4)+ coord_flip()+
theme_bw()+ xlab("Risk ID")+ theme(legend.position = "none", axis.text.x=element_text(size=14, face = "bold"), axis.text.y=element_text(size=14, face = "bold"), axis.title.y =element_text(size=14, face = "bold"))
   

       print(gg_dat_individual)
       
      dev.off()
      }
    
 )

    
   
    
```

<br>
<br>

### **The following chart shows the sum of monitoring techniques assigned for assessed risks**
```{r echo=FALSE, error=FALSE}
# vals <- reactiveValues()

library(plotrix)

# 
#  renderPlot({ 
#   Df_output() %>%  count(Monitoring) %>% mutate(per=paste0(round(n/sum(n)*100,digits =2 ), "%"), per_n=paste(n, paste(per, paste(""), sep =")" ), sep = " (")) %>% ggplot(aes(Monitoring , n, fill=Monitoring))+ geom_bar(stat = "identity")+ geom_text(aes(label=per_n), vjust=-0.5, size=5)+theme_classic()+ ylab("Number of risks monitored by each technique")+ 
#      theme(axis.title.y = element_text(face = "bold", size = 13), axis.text.y = element_text(face = "bold", size = 11), 
#            axis.text.x = element_text(face = "bold", size = 11), 
#            legend.title=element_text(size=11, face = "bold"), legend.text=element_text(size=10, face = "bold"))+ labs(fill = "Monitoring Strategy")+ xlab("")
#     
#     })
dat_pie <- data.frame(Monitoring=c( "Remote Monitoring", "Onsite Monitoring", "Remote Monitoring", "Onsite Monitoring", "Remote Monitoring", "Remote Monitoring", "Remote Monitoring", "Remote Monitoring", "Remote Monitoring", "Onsite Monitoring"))

dat_pie_reac <- reactive({
  Df_output()%>% #select(Risk, Monitoring) %>% filter(complete.cases(.))
                  filter(!Monitoring %in%c(""))
                                                })

#renderPrint(nrow(dat_pie_reac()))
#renderPrint(str(dat_pie_reac()))

#renderPrint((dat_pie_reac()))

dat_Pie_final <- reactive({
  
   tt <- if(nrow(dat_pie_reac()) >=1 ){
 dat_pie_reac()
}else{
  #print("data.frame contains data")
  dat_pie
}
   
})

#renderPrint((dat_Pie_final()))

 renderPlot({ 
   
BB_Pie <- dat_Pie_final() %>%  count(Monitoring) %>% mutate(per=paste0(round(n/sum(n)*100,digits =2 ), "%"), per_n=paste(n, paste(per, paste(""), sep =")" ), sep = " ("))
   
# lbls <- paste(BB_Pie$Monitoring, paste(BB_Pie$n, " ", sep = ")"), sep = " (")
# slices <- BB_Pie$n
#    pie3D(slices,labels=lbls,explode=0.1,
#       main="Number of risks monitored by each technique")
   
dat_Pie_final() %>%  count(Monitoring) %>% mutate(per=paste0(round(n/sum(n)*100,digits =2 ), "%"), per_n=paste(n, paste(per, paste(""), sep =")" ), sep = " (")) %>% ggplot(aes(Monitoring , n, fill=Monitoring))+ geom_bar(stat = "identity")+ geom_text(aes(label=per_n), vjust=-0.5, size=5)+theme_classic()+ ylab("Number of risks monitored by each technique")+ 
      theme(axis.title.y = element_text(face = "bold", size = 13), axis.text.y = element_text(face = "bold", size = 11), 
            axis.text.x = element_text(face = "bold", size = 11), 
            legend.title=element_text(size=11, face = "bold"), legend.text=element_text(size=10, face = "bold"))+ labs(fill = "Monitoring Strategy")+ xlab("")+ theme(legend.position="none") 
   
    })

# BB_Pie <- data.frame(Monitoring=c( "Remote Monitoring", "Onsite Monitoring", "Remote Monitoring", "Onsite Monitoring", "Remote Monitoring", "Remote Monitoring", "Remote Monitoring", "Remote Monitoring", "Remote Monitoring", "Onsite Monitoring")) %>%  count(Monitoring) %>% mutate(per=paste0(round(n/sum(n)*100,digits =2 ), "%"), per_n=paste(n, paste(per, paste(""), sep =")" ), sep = " ("))
# 
# lbls <- paste(BB_Pie$Monitoring, paste(BB_Pie$n, " ", sep = ")"), sep = " (")
# slices <- BB_Pie$n
#    pie3D(slices,labels=lbls,explode=0.1,
#       main="Number of risks monitored by each technique")
 
```

Overall counts of risks covered by each monitoring technique. 

```{r report, echo=FALSE}
 mainPanel( downloadButton(outputId = "GG", label = "Graph download"))

    output$GG <- downloadHandler(
    filename = function() {
        "plot.pdf"
    },
    content = function(file) {
       pdf(file, width = 10, height = 7)
      
 BB_Pie <- dat_Pie_final() %>%  count(Monitoring) %>% mutate(per=paste0(round(n/sum(n)*100,digits =2 ), "%"), per_n=paste(n, paste(per, paste(""), sep =")" ), sep = " ("))
   
lbls <- paste(BB_Pie$Monitoring, paste(BB_Pie$n, " ", sep = ")"), sep = " (")
slices <- BB_Pie$n
  gg <- dat_Pie_final() %>%  count(Monitoring) %>% mutate(per=paste0(round(n/sum(n)*100,digits =2 ), "%"), per_n=paste(n, paste(per, paste(""), sep =")" ), sep = " (")) %>% ggplot(aes(Monitoring , n, fill=Monitoring))+ geom_bar(stat = "identity")+ geom_text(aes(label=per_n), vjust=-0.5, size=5)+theme_classic()+ ylab("Number of risks monitored by each technique")+ 
      theme(axis.title.y = element_text(face = "bold", size = 13), axis.text.y = element_text(face = "bold", size = 11), 
            axis.text.x = element_text(face = "bold", size = 11), 
            legend.title=element_text(size=11, face = "bold"), legend.text=element_text(size=10, face = "bold"))+ labs(fill = "Monitoring Strategy")+ xlab("")+ theme(legend.position="none") 
       print(gg)
       
      dev.off()
      }
    
 )

    
   
    
```

 <br>
 <br>

### **Visualizing risks differences**

```{r line, echo=FALSE}

#renderTable(Df_output(), striped = TRUE, bordered = TRUE,  width = '100%')
  # fake_dat <- data.frame(Risk=c("Risk A", "Risk B", "Risk C", "Risk D"), Impact=c(6, 3, 2,4), Probability=c(5, 2, 1,3), Detectability=c(2,1,1,1), Score=c(50, 45, 90, 70)) %>% as.data.frame()  %>% mutate(ID = as.character(row_number()))


dat_LIne <- reactive({
 dat_LIne_needed <-  Df_output()[, c(1, 2,3,4,5, 6)] %>% mutate(Impact=as.numeric(Impact), Probability=as.numeric(Probability), 
                                     Detectability=as.numeric(Detectability)) %>% filter(complete.cases(.)) %>% 
   mutate(ID = as.character(row_number()))
 

  })

#renderTable(dat_LIne())


#renderPrint(names(dat_LIne_final()))

renderPlot({
  
dat_LIne_final() %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact)) %>% pivot_longer(names_to = "input", values_to = "Score", cols = c(Impact, Probability, Detectability, Score)) %>% filter(!input %in% c("Score")) %>% 
    ggplot(aes(ID, Score, group=input, color=input) )+
     geom_hline(yintercept = 2, color="red", size=1, linetype="dashed")+ geom_hline(yintercept = 5, color="green", size=1, linetype="dashed")+ 
  geom_hline(yintercept = 6, color="blue", size=1, linetype="dashed")+
  geom_point(aes(shape=input, size=3))+
    geom_line()+ coord_flip()+theme_bw()+ 
  scale_color_manual(breaks = c("Detectability", "Impact", "Probability"),
                     values=c("red", "blue", "green"))+
    xlab("Risk ID")+ guides( size = FALSE, shape=FALSE)+ 
    theme(axis.text.x=element_text(size=14, face = "bold"), axis.text.y=element_text(size=14, face = "bold"), 
          legend.title=element_blank(), legend.text=element_text(size=11, face = "bold"), 
          axis.title.y=element_text(size=14, face="bold"))+ylab("")+ 
    geom_jitter(position=position_jitter(width = 0.1, height = 0.1))
})


#   renderPlotly({
#  
# dat_LIne_final() %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact)) %>% pivot_longer(names_to = "input", values_to = "Score", cols = c(Impact, Probability, Detectability, Score)) %>% filter(!input %in% c("Score")) %>% ggplot(aes(Risk, Score, group=input, color=input) )+ geom_point(aes(shape=input))+ geom_line()+ coord_flip()+
#   facet_wrap(~input, scale="free", ncol = 1, nrow = 3)+ theme_bw()+
#   scale_color_manual(breaks = c("Detectability", "Impact", "Probability"),
#                      values=c("red", "blue", "green")) +xlab("")
# 
#   
# }
#   
# )


  #  fake_dat %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact)) %>% pivot_longer(names_to = "input", values_to = "Score", cols = c(Impact, Probability, Detectability, Score)) %>% filter(!input %in% c("Score")) %>%   ggplot(aes(Risk, Score, group=input, color=input) )+
  #    geom_hline(yintercept = 2, color="red", size=1, linetype="dashed")+ geom_hline(yintercept = 5, color="green", size=1, linetype="dashed")+
  # geom_hline(yintercept = 6, color="blue", size=1, linetype="dashed")+
  # geom_point(aes(shape=input, size=3))+ geom_line()+ coord_flip()+theme_bw()+
  # scale_color_manual(breaks = c("Detectability", "Impact", "Probability"),
  #                    values=c("red", "blue", "green"))+
  #   xlab("")+ guides( size = FALSE, shape=FALSE)+
  #   theme(axis.text.x=element_text(size=14, face = "bold"), axis.text.y=element_text(size=14, face = "bold"),
  #               legend.title=element_blank(), legend.text=element_text(size=11, face = "bold"))+ylab("")+
  #   geom_jitter(position=position_jitter(width = 0.1, height = 0.1))
```
Risks based on the input of the assessment; red, green and blue points are compared to their respective colored dashed lines representing the maximum score.
```{r reporrt, echo=FALSE, eval=TRUE}
 mainPanel( downloadButton(outputId = "GG_risk", label = "Graph download"))

    output$GG_risk <- downloadHandler(
    filename = function() {
        "plot.pdf"
    },
    content = function(file) {
       pdf(file, width = 10, height = 7)
      
 gg_dat <- dat_LIne_final() %>% filter(complete.cases(.)) %>% mutate(Impact=as.integer(Impact)) %>% pivot_longer(names_to = "input", values_to = "Score", cols = c(Impact, Probability, Detectability, Score)) %>% filter(!input %in% c("Score")) %>% 
    ggplot(aes(ID, Score, group=input, color=input) )+
     geom_hline(yintercept = 2, color="red", size=1, linetype="dashed")+ geom_hline(yintercept = 5, color="green", size=1, linetype="dashed")+ 
  geom_hline(yintercept = 6, color="blue", size=1, linetype="dashed")+
  geom_point(aes(shape=input, size=3))+
    geom_line()+ coord_flip()+theme_bw()+ 
  scale_color_manual(breaks = c("Detectability", "Impact", "Probability"),
                     values=c("red", "blue", "green"))+
    xlab("Risk ID")+ guides( size = FALSE, shape=FALSE)+ 
    theme(axis.text.x=element_text(size=14, face = "bold"), axis.text.y=element_text(size=14, face = "bold"), 
          legend.title=element_blank(), legend.text=element_text(size=11, face = "bold"), 
          axis.title.y=element_text(size=14, face="bold"))+ylab("")+ 
    geom_jitter(position=position_jitter(width = 0.1, height = 0.1))
   

       print(gg_dat)
       
      dev.off()
      }
    
 )


    
```

